{"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"CustomerCard4":{"sourceUuid":"7278c4f8-203b-4e66-829e-abc901d2adc3","name":"CustomerCard4","program":"EXT001MI","description":"Querues for customer card","active":true,"multi":true,"modified":1763880427730,"modifiedBy":"ERP2024","outputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":false,"type":"A","refField":null},{"name":"DIVI","description":"Division","length":3,"mandatory":false,"type":"A","refField":null},{"name":"PYNO","description":"Payer","length":20,"mandatory":false,"type":"A","refField":null},{"name":"CUNO","description":"Customer number","length":20,"mandatory":false,"type":"A","refField":null},{"name":"TX15","description":"Voucher type","length":15,"mandatory":false,"type":"A","refField":null},{"name":"VONO","description":"Voucher number","length":20,"mandatory":false,"type":"A","refField":null},{"name":"ACDT","description":"Accounting date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"OCDT","description":"Movement date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"DBCR","description":"D or C","length":1,"mandatory":false,"type":"A","refField":null},{"name":"DUDT","description":"Due date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"DCUA","description":"D_Amount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"CCUA","description":"C_Amount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"DACA","description":"D_LocalAmount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"CACA","description":"C_LocalAmount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"DTCA","description":"D_ThirdCurrentAmount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"CTCA","description":"C_ThirdCurrentAmount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"ARAT","description":"Rate","length":30,"mandatory":false,"type":"A","refField":null},{"name":"TCAR","description":"Third rate","length":30,"mandatory":false,"type":"A","refField":null},{"name":"PYRS","description":"Status","length":4,"mandatory":false,"type":"A","refField":null},{"name":"IVTP","description":"IVTP","length":20,"mandatory":false,"type":"A","refField":null},{"name":"TRCD","description":"TRCD","length":20,"mandatory":false,"type":"A","refField":null},{"name":"FEID","description":"FEID","length":20,"mandatory":false,"type":"A","refField":null},{"name":"FNCN","description":"FNCN","length":20,"mandatory":false,"type":"A","refField":null},{"name":"REFE","description":"Reference","length":20,"mandatory":false,"type":"A","refField":null},{"name":"VTXT","description":"VTXT","length":20,"mandatory":false,"type":"A","refField":null},{"name":"TCUA","description":"Total amount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"TACA","description":"Total local amount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"TTCA","description":"Total third amount","length":30,"mandatory":false,"type":"A","refField":null},{"name":"CUNM","description":"Customer name","length":30,"mandatory":false,"type":"A","refField":null},{"name":"CUCD","description":"Currency","length":3,"mandatory":false,"type":"A","refField":null},{"name":"PYNM","description":"Payer name","length":20,"mandatory":false,"type":"A","refField":null}],"inputFields":[{"name":"FCUS","description":"From customer","length":20,"mandatory":false,"type":"A","refField":null},{"name":"TCUS","description":"To customer","length":20,"mandatory":false,"type":"A","refField":null},{"name":"PYNO","description":"Payer","length":20,"mandatory":false,"type":"A","refField":null},{"name":"FDAT","description":"From date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"TDAT","description":"To date","length":8,"mandatory":false,"type":"A","refField":null}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"7278c4f8-203b-4e66-829e-abc901d2adc3":{"uuid":"7278c4f8-203b-4e66-829e-abc901d2adc3","updated":1762324986999,"updatedBy":"YAEL","created":1763880421616,"createdBy":"ERP2024","apiVersion":"0.21","beVersion":"16.0.0.20250917153352.6","language":"GROOVY","codeHash":"431C5A23613109D2F4C359E14BE8E9755C39D979F05B8435BDDDDF388B0BFF4E","code":"aW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOw0KaW1wb3J0IGphdmEubWF0aC5Sb3VuZGluZ01vZGU7DQppbXBvcnQgamF2YS51dGlsLio7DQppbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzOw0KaW1wb3J0IGphdmEudXRpbC5EYXRlOw0KaW1wb3J0IGphdmEudGV4dC5TaW1wbGVEYXRlRm9ybWF0Ow0KaW1wb3J0IGphdmEudXRpbC5DYWxlbmRhcjsNCg0KcHVibGljIGNsYXNzIEN1c3RvbWVyQ2FyZDQgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZTsNCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW07DQogIHByaXZhdGUgZmluYWwgTG9nZ2VyQVBJIGxvZ2dlcjsNCiAgDQogIFN0cmluZyBmcm9tQ3VzdG9tZXI7DQogIFN0cmluZyB0b0N1c3RvbWVyOw0KICBTdHJpbmcgcGF5ZXI7DQogIFN0cmluZyBmcm9tRGF0ZTsNCiAgU3RyaW5nIHRvRGF0ZTsNCiAgYm9vbGVhbiBpc1BheWVyOw0KICBib29sZWFuIGlzRnJvbUN1c3Q7DQogIGJvb2xlYW4gaXNUb0N1c3Q7DQogIExpc3Q8TWFwPFN0cmluZyxTdHJpbmc+PiBmc2xlZGdMaXN0Ow0KICBMaXN0PE1hcDxTdHJpbmcsU3RyaW5nPj4gZmdsZWRnTGlzdDsNCiAgTGlzdDxNYXA8U3RyaW5nLFN0cmluZz4+IGZkcmZtYUxpc3Q7DQogIExpc3Q8TWFwPFN0cmluZyxTdHJpbmc+PiBjc3luYnZMaXN0Ow0KICBMaXN0PE1hcDxTdHJpbmcsU3RyaW5nPj4gb2N1c21hTGlzdDsNCiAgcHVibGljIEN1c3RvbWVyQ2FyZDQoTUlBUEkgbWksRGF0YWJhc2VBUEkgZGF0YWJhc2UsIFByb2dyYW1BUEkgcHJvZ3JhbSwgTG9nZ2VyQVBJIGxvZ2dlcikgew0KICAgIHRoaXMubWkgPSBtaTsNCiAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2U7DQogICAgdGhpcy5wcm9ncmFtID0gcHJvZ3JhbTsNCiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcjsNCiAgfQ0KDQogIHB1YmxpYyB2b2lkIG1haW4oKSB7DQogICAgcGF5ZXI9bWkuaW5EYXRhLmdldCgiUFlOTyIpLnRyaW0oKTsNCiAgICBmcm9tQ3VzdG9tZXI9bWkuaW5EYXRhLmdldCgiRkNVUyIpLnRyaW0oKTsNCiAgICB0b0N1c3RvbWVyPW1pLmluRGF0YS5nZXQoIlRDVVMiKS50cmltKCk7DQogICAgaXNQYXllcj10cnVlOw0KICAgIGlzRnJvbUN1c3Q9dHJ1ZTsNCiAgICBpc1RvQ3VzdD10cnVlOw0KICAgIGlmKHBheWVyPT1udWxsfHxwYXllci5lcXVhbHMoIiIpKXsNCiAgICAgIGlzUGF5ZXI9ZmFsc2U7DQogICAgfQ0KICAgIGlmKGZyb21DdXN0b21lcj09bnVsbHx8ZnJvbUN1c3RvbWVyLmVxdWFscygiIikpew0KICAgICAgaXNGcm9tQ3VzdD1mYWxzZTsNCiAgICB9DQogICAgaWYodG9DdXN0b21lcj09bnVsbHx8dG9DdXN0b21lci5lcXVhbHMoIiIpKXsNCiAgICAgIGlzVG9DdXN0PWZhbHNlOw0KICAgICAgDQogICAgfQ0KICAgIGlmKCghaXNQYXllciYmIWlzRnJvbUN1c3QmJiFpc1RvQ3VzdCkpew0KICAgICAgdGhpcy5taS5lcnJvcigiY3VzdG9tZXIgbXVzdCBiZSBlbnRlcmVkIik7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGZyb21EYXRlPW1pLmluRGF0YS5nZXQoIkZEQVQiKS50cmltKCk7DQogICAgdG9EYXRlPW1pLmluRGF0YS5nZXQoIlREQVQiKS50cmltKCk7DQogICAgLyppZihmcm9tRGF0ZT09bnVsbHx8ZnJvbURhdGUuZXF1YWxzKCIiKSl7DQogICAgICBmcm9tRGF0ZT1nZXRTdGFydFllYXJEYXRlKCk7DQogICAgfSovDQogICAgaWYodG9EYXRlPT1udWxsfHx0b0RhdGUuZXF1YWxzKCIiKSl7DQogICAgICB0b0RhdGU9Z2V0Q3VycmVudERhdGUoKTsNCiAgICB9DQogICAgZnNsZWRnTGlzdD1uZXcgQXJyYXlMaXN0PD4oKTsNCiAgICBmZ2xlZGdMaXN0PW5ldyBBcnJheUxpc3Q8PigpOw0KICAgIGZkcmZtYUxpc3Q9bmV3IEFycmF5TGlzdDw+KCk7DQogICAgY3N5bmJ2TGlzdD1uZXcgQXJyYXlMaXN0PD4oKTsNCiAgICBvY3VzbWFMaXN0PW5ldyBBcnJheUxpc3Q8PigpOw0KICAgIHJlYWRSZWNvcmRzRlNMRURHKCk7DQogICAgLy9zb3J0VGFibGUoZnNsZWRnTGlzdCwiQUNEVCIpOw0KICAgIGJ1YmJsZVNvcnQoZnNsZWRnTGlzdCwiQUNEVCIpOw0KICAgIHJlYWRSZWNvcmRzRkdMRURHKCk7DQogICAgcmVhZFJlY29yZHNGRFJGTUEoKTsNCiAgICByZWFkUmVjb3Jkc0NTWU5CVigpOw0KICAgIA0KICAgIA0KICAgIGlmKGZzbGVkZ0xpc3QuaXNFbXB0eSgpKXsNCiAgICAgIG1pLmVycm9yKCJyZXN1bHRzIG5vdCBmb3VuZCIpOw0KICAgIH0NCiAgICAvLyBDcmVhdGUgbWFwcyBmb3IgcXVpY2sgbG9va3VwDQogICAgICAgIE1hcDxTdHJpbmcsIE1hcDxTdHJpbmcsIFN0cmluZz4+IGZnbGVkZ01hcCA9IG5ldyBIYXNoTWFwPD4oKTsNCiAgICAgICAgZm9yIChNYXA8U3RyaW5nLCBTdHJpbmc+IGcgOiBmZ2xlZGdMaXN0KSB7DQogICAgICAgICAgICBTdHJpbmcga2V5ID0gZy5nZXQoIkNPTk8iKS50b1N0cmluZygpICsgIi0iICsgZy5nZXQoIkRJVkkiKS50b1N0cmluZygpICsgIi0iICsgZy5nZXQoIllFQTQiKS50b1N0cmluZygpICsgIi0iICsgZy5nZXQoIkpSTk8iKS50b1N0cmluZygpICsgIi0iICsgZy5nZXQoIkpTTk8iKS50b1N0cmluZygpOw0KICAgICAgICAgICAgaWYoIWZnbGVkZ01hcC5jb250YWluc0tleShrZXkpKXsNCiAgICAgICAgICAgICAgZmdsZWRnTWFwLnB1dChrZXksIGcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgTWFwPFN0cmluZywgTWFwPFN0cmluZywgU3RyaW5nPj4gZmRyZm1hTWFwID0gbmV3IEhhc2hNYXA8PigpOw0KICAgICAgICBmb3IgKE1hcDxTdHJpbmcsIFN0cmluZz4gZCA6IGZkcmZtYUxpc3QpIHsNCiAgICAgICAgICAgIFN0cmluZyBrZXkgPSBkLmdldCgiQ09OTyIpLnRvU3RyaW5nKCkgKyAiLSIgKyBkLmdldCgiRElWSSIpLnRvU3RyaW5nKCkgKyAiLSIgKyBkLmdldCgiQ0lOTyIpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICBpZighZmRyZm1hTWFwLmNvbnRhaW5zS2V5KGtleSkpew0KICAgICAgICAgICAgICBmZHJmbWFNYXAucHV0KGtleSwgZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIE1hcDxTdHJpbmcsIE1hcDxTdHJpbmcsIFN0cmluZz4+IGNzeW5idk1hcCA9IG5ldyBIYXNoTWFwPD4oKTsNCiAgICAgICAgZm9yIChNYXA8U3RyaW5nLCBTdHJpbmc+IHYgOiBjc3luYnZMaXN0KSB7DQogICAgICAgICAgICBTdHJpbmcga2V5ID0gdi5nZXQoIkNPTk8iKS50b1N0cmluZygpICsgIi0iICsgdi5nZXQoIkRJVkkiKS50b1N0cmluZygpICsgIi0iICsgdi5nZXQoIlZTRVIiKS50b1N0cmluZygpOw0KICAgICAgICAgICAgaWYoIWNzeW5idk1hcC5jb250YWluc0tleShrZXkpKXsNCiAgICAgICAgICAgICAgY3N5bmJ2TWFwLnB1dChrZXksIHYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBNYXA8U3RyaW5nLCBNYXA8U3RyaW5nLCBTdHJpbmc+PiBvY3VzbWFNYXAgPSBuZXcgSGFzaE1hcDw+KCk7DQogICAgICAgIGZvciAoTWFwPFN0cmluZywgU3RyaW5nPiBvIDogb2N1c21hTGlzdCkgew0KICAgICAgICAgICAgU3RyaW5nIGtleSA9IG8uZ2V0KCJDT05PIikudG9TdHJpbmcoKSArICItIiArIG8uZ2V0KCJDVU5PIikudG9TdHJpbmcoKTsNCiAgICAgICAgICAgIGlmKCFvY3VzbWFNYXAuY29udGFpbnNLZXkoa2V5KSl7DQogICAgICAgICAgICAgIG9jdXNtYU1hcC5wdXQoa2V5LCBvKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIExpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4gcmVzdWx0TGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpOw0KICAgICAgICAgDQogICAgICAgIGZvciAoTWFwPFN0cmluZywgU3RyaW5nPiBzIDogZnNsZWRnTGlzdCkgew0KICAgICAgICAgICAgU3RyaW5nIGtleUcgPSBzLmdldCgiQ09OTyIpLnRvU3RyaW5nKCkgKyAiLSIgKyBzLmdldCgiRElWSSIpLnRvU3RyaW5nKCkgKyAiLSIgKyBzLmdldCgiWUVBNCIpLnRvU3RyaW5nKCkgKyAiLSIgKyBzLmdldCgiSlJOTyIpLnRvU3RyaW5nKCkgKyAiLSIgKyBzLmdldCgiSlNOTyIpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IGcgPSBmZ2xlZGdNYXAuZ2V0KGtleUcpOw0KDQogICAgICAgICAgICBTdHJpbmcga2V5RCA9IHMuZ2V0KCJDT05PIikudG9TdHJpbmcoKSArICItIiArIHMuZ2V0KCJESVZJIikudG9TdHJpbmcoKSArICItIiArIHMuZ2V0KCJDSU5PIikudG9TdHJpbmcoKTsNCiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gZCA9IGZkcmZtYU1hcC5nZXQoa2V5RCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIFN0cmluZyBrZXlWID0gcy5nZXQoIkNPTk8iKS50b1N0cmluZygpICsgIi0iICsgcy5nZXQoIkRJVkkiKS50b1N0cmluZygpICsgIi0iICsgcy5nZXQoIlZTRVIiKS50b1N0cmluZygpOw0KICAgICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiB2ID0gY3N5bmJ2TWFwLmdldChrZXlWKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgU3RyaW5nIGtleU8gPSBzLmdldCgiQ09OTyIpLnRvU3RyaW5nKCkgKyAiLSIgKyBzLmdldCgiQ1VOTyIpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IG8gPSBvY3VzbWFNYXAuZ2V0KGtleU8pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBTdHJpbmcga2V5UCA9IHMuZ2V0KCJDT05PIikudG9TdHJpbmcoKSArICItIiArIHMuZ2V0KCJQWU5PIikudG9TdHJpbmcoKTsNCiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcCA9IG9jdXNtYU1hcC5nZXQoa2V5UCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLyppZighaXNQYXllciYmaXNGcm9tQ3VzdCl7DQogICAgICAgICAgICAgIGNvbmRpdGlvbj1vLmdldCgiUFlOTyIpLmVxdWFscygiIik/dHJ1ZTpzLmdldCgiUFlOTyIpPT1vLmdldCgiUFlOTyIpOw0KICAgICAgICAgICAgfSovDQoNCiAgICAgICAgICAgIGlmIChnICE9IG51bGwmJiB2IT1udWxsICkgew0KICAgICAgICAgICAgDQogICAgICAgICAgICAgIC8vWWFlbCAwNS8xMS8yMDI1DQogICAgICAgICAgICAgIFN0cmluZyB0cmNkID0gZy5nZXQoIlRSQ0QiKTsNCiAgICAgICAgICAgICAgU3RyaW5nIGZlaWQgPSBnLmdldCgiRkVJRCIpOw0KICAgICAgICAgICAgICBTdHJpbmcgZm5jbiA9IGcuZ2V0KCJGTkNOIik7DQogICAgICAgICAgICAgIFN0cmluZyBpdnRwID0gcy5nZXQoIklWVFAiKTsNCiAgICAgICAgICAgICAgU3RyaW5nIHB5cnMgPSBzLmdldCgiUFlSUyIpOw0KICAgICAgICAgICAgICAvLw0KICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAvKmlmKChnLmdldCgiVFJDRCIpLmVxdWFscygiMTAiKSANCiAgICAgICAgICAgICAgJiYgIXMuZ2V0KCJJVlRQIikuZXF1YWxzKCJBUCIpKSANCiAgICAgICAgICAgICAgfHwoKGcuZ2V0KCJUUkNEIikuZXF1YWxzKCIxMCIpIA0KICAgICAgICAgICAgICB8fGcuZ2V0KCJUUkNEIikuZXF1YWxzKCIyMCIpKQ0KICAgICAgICAgICAgICAmJmcuZ2V0KCJGRUlEIikuZXF1YWxzKCJBQjEwIikNCiAgICAgICAgICAgICAgJiZnLmdldCgiRk5DTiIpLmVxdWFscygiMTAwIikNCiAgICAgICAgICAgICAgLyomJmNvbmRpdGlvbikpeyovDQogICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAvL1dIRVJFIGNvbmRpdGlvbg0KICAgICAgICAgICAgICBpZigNCiAgICAgICAgICAgICAgKCh0cmNkLmVxdWFscygiMTAiKSAmJiAhaXZ0cC5lcXVhbHMoIkFQIikpIHx8DQogICAgICAgICAgICAgICgodHJjZC5lcXVhbHMoIjEwIikgfHwgdHJjZC5lcXVhbHMoIjIwIikpICYmIGZlaWQuZXF1YWxzKCJBQjEwIikgJiYgZm5jbi5lcXVhbHMoIjEwMCIpKSB8fA0KICAgICAgICAgICAgICAoZmVpZC5lcXVhbHMoIkFSMjAiKSB8fCBmZWlkLmVxdWFscygiT0kyMCIpKSB8fA0KICAgICAgICAgICAgICAvL1lhZWwgMDUvMTEvMjAyNQ0KICAgICAgICAgICAgICAodHJjZC5lcXVhbHMoIjIwIikgJiYgKGZlaWQuZXF1YWxzKCJBUDMwIikgfHwgZmVpZC5lcXVhbHMoIkFQMzIiKSkgJiYNCiAgICAgICAgICAgICAgKHB5cnMgPT0gbnVsbCB8fCBweXJzLmlzRW1wdHkoKSB8fCBweXJzLmNvbXBhcmVUbygiNzAiKSA8IDApKSB8fA0KICAgICAgICAgICAgICAodHJjZC5lcXVhbHMoIjIwIikgJiYgZmVpZC5zdGFydHNXaXRoKCJBUCIpICYmICFmbmNuLmVxdWFscygiNTAwIikpKQ0KICAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZXN1bHQgPSBuZXcgSGFzaE1hcDw+KCk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiQ09OTyIsIHMuZ2V0KCJDT05PIikpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkRJVkkiLCBzLmdldCgiRElWSSIpKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJQWU5PIiwgcy5nZXQoIlBZTk8iKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiQ1VOTyIsIHMuZ2V0KCJDVU5PIikpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIlRYMTUiLCB2LmdldCgiVFgxNSIpKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJWT05PIiwgcy5nZXQoIlZPTk8iKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiQUNEVCIsIHMuZ2V0KCJBQ0RUIikpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIk9DRFQiLCBnLmdldCgiT0NEVCIpKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZihmZWlkLmVxdWFscygiQVIyMCIpIHx8IGZlaWQuZXF1YWxzKCJPSTIwIikpew0KICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiREJDUiIsIGcuZ2V0KCJEQkNSIikpOy8v16HXm9eV150g15HXl9eV15HXlCDXkNeVINeR15bXm9eV16oNCiAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkRVRFQiLCBzLmdldCgiRFVEVCIpKTsNCiAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkNVQU0iLCByb3VuZChzLmdldCgiQ1VBTSIpLCAyKSk7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJBQ0FNIiwgcm91bmQoZy5nZXQoIkFDQU0iKSwgMikpOw0KICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiVENBTSIsIHJvdW5kKGcuZ2V0KCJUQ0FNIiksIDIpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/Xodeb15XXnSDXkdeW15vXldeqDQogICAgICAgICAgICAgICAgZWxzZSBpZihmZWlkLmVxdWFscygiQVIzMCIpICYmIGcuZ2V0KCJEQkNSIikuZXF1YWxzKCJEIikpew0KICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiREJDUiIsICJDIik7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJEVURUIiwgZC5nZXQoIkRVRFQiKSk7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJDVUFNIiwgcm91bmQoU3RyaW5nLnZhbHVlT2YoRG91YmxlLnZhbHVlT2Yocy5nZXQoIkNVQU0iKSkqLTEpLCAyKSk7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJBQ0FNIiwgcm91bmQoU3RyaW5nLnZhbHVlT2YoRG91YmxlLnZhbHVlT2YoZy5nZXQoIkFDQU0iKSkqLTEpLCAyKSk7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJUQ0FNIiwgcm91bmQoU3RyaW5nLnZhbHVlT2YoRG91YmxlLnZhbHVlT2YoZy5nZXQoIlRDQU0iKSkqLTEpLCAyKSk7DQogICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZXsNCiAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkRCQ1IiLCBnLmdldCgiREJDUiIpKTsvL9eh15vXldedINeR15fXldeR15Qg15DXlSDXkdeW15vXldeqDQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJEVURUIiwgZCAhPSBudWxsID8gZC5nZXQoIkRVRFQiKSA6IHMuZ2V0KCJEVURUIikpOw0KICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiQ1VBTSIsIHJvdW5kKHMuZ2V0KCJDVUFNIiksIDIpKTsNCiAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkFDQU0iLCByb3VuZChnLmdldCgiQUNBTSIpLCAyKSk7DQogICAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJUQ0FNIiwgcm91bmQoZy5nZXQoIlRDQU0iKSwgMikpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJJVlRQIiwgaXZ0cCk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiVFJDRCIsIHRyY2QpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkNJTk8iLCBzLmdldCgiQ0lOTyIpKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJEUlJOIiwgZCAhPSBudWxsID8gZC5nZXQoIkRSUk4iKSA6IG51bGwpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIlZUWFQiLCBnLmdldCgiVlRYVCIpKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJBUkFUIiwgcm91bmQoZy5nZXQoIkFSQVQiKSwgNikpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIlRDQVIiLCByb3VuZChnLmdldCgiVENBUiIpLCA2KSk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiUFlSUyIsIHB5cnMpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkZFSUQiLCBmZWlkKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJGTkNOIiwgZm5jbik7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiUkVGRSIsIGQgPT0gbnVsbCA/IHMuZ2V0KCJDSU5PIikgOiAgZC5nZXQoIkRSUk4iKSk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnB1dCgiQ1VOTSIsIG8uZ2V0KCJDVU5NIikpOw0KICAgICAgICAgICAgICAgIHJlc3VsdC5wdXQoIkNVQ0QiLCBzLmdldCgiQ1VDRCIpKTsNCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KCJQWU5NIiwgcC5nZXQoIkNVTk0iKSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcmVzdWx0TGlzdC5hZGQocmVzdWx0KTsNCiAgICAgICAgICAgICAgDQogICAgICAgIH0NCiAgICAgICAgLy9yZXN1bHRMaXN0LnNvcnQoQ29tcGFyYXRvci5jb21wYXJpbmcobSAtPiAoQ29tcGFyYWJsZSkgbS5nZXQoIkFDRFQiKSkpOw0KICAgICAgfQ0KICAgICAgLy8gZWxzZXsNCiAgICAgIC8vICAgbWkuZXJyb3IoInJlc3VsdHMgbm90IGZvdW5kIik7DQogICAgICAvLyB9DQogICAgICANCiAgICB9DQogICAgcHJpbnREYXRhKHJlc3VsdExpc3QpOw0KICAgIA0KICB9DQogIA0KICANCiAgdm9pZCBwcmludERhdGEoTGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiByZXN1bHRMaXN0KXsNCiAgICBCaWdEZWNpbWFsIHN1bVRvdGFsQ1VBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1Ub3RhbEFDQU09QmlnRGVjaW1hbC5aRVJPOw0KICAgIEJpZ0RlY2ltYWwgc3VtVG90YWxUQ0FNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgDQogICAgQmlnRGVjaW1hbCBzdW1EQ1VBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1EQUNBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1EVENBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1DQ1VBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1DQUNBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgQmlnRGVjaW1hbCBzdW1DVENBTT1CaWdEZWNpbWFsLlpFUk87DQogICAgICANCiAgICBpbnQgY250TGluZXM9LTE7DQogICAgYm9vbGVhbiBmaXJzdEN1c3RPcGVuTGluZT10cnVlOw0KICAgIGJvb2xlYW4gaGFzT3BlbkxpbmU9ZmFsc2U7DQogICAgYm9vbGVhbiBjb25kaXRpb249dHJ1ZTsNCiAgICBTdHJpbmcgc3VtTGluZVRvdGFsQ1VBTT0iIjsNCiAgICBTdHJpbmcgc3VtTGluZVRvdGFsQUNBTT0iIjsNCiAgICBTdHJpbmcgc3VtTGluZVRvdGFsVENBTT0iIjsNCiAgICANCiAgICBTdHJpbmcgTGluZURDVUFNPSIiOw0KICAgIFN0cmluZyBMaW5lREFDQU09IiI7DQogICAgU3RyaW5nIExpbmVEVENBTT0iIjsNCiAgICBTdHJpbmcgTGluZUNDVUFNPSIiOw0KICAgIFN0cmluZyBMaW5lQ0FDQU09IiI7DQogICAgU3RyaW5nIExpbmVDVENBTT0iIjsNCiAgICANCiAgICAvLyBpZihyZXN1bHRMaXN0LmlzRW1wdHkoKSl7DQogICAgLy8gICBwcmludE91dExpbmUobnVsbCwi15kuINek16rXmdeX15Qg15zXntep15zXnSIsc3VtRENVQU0sItec16rXkNeo15nXmiIsc3VtREFDQU0sc3VtRFRDQU0sc3VtQ0NVQU0sc3VtQ0FDQU0sc3VtQ1RDQU0sc3VtVG90YWxDVUFNLHN1bVRvdGFsQUNBTSxzdW1Ub3RhbFRDQU0pOw0KICAgIC8vICAgcmV0dXJuOw0KICAgIC8vIH0NCiAgICBTdHJpbmcgdG89IiI7DQogICAgaWYoaXNGcm9tQ3VzdCl7DQogICAgICB0bz0i15zXnNen15XXlyI7DQogICAgfQ0KICAgIGVsc2V7DQogICAgICB0bz0i15zXntep15zXnSI7DQogICAgfQ0KICAgIA0KICAgIGZvcihNYXA8U3RyaW5nLCBTdHJpbmc+IHJlc3VsdCA6IHJlc3VsdExpc3Qpew0KICAgICAgY250TGluZXMrKzsNCiAgICAgIGhhc09wZW5MaW5lPWZhbHNlOw0KICAgICAgDQogICAgICBpZihjbnRMaW5lcz09MCl7DQogICAgICAgIGlmKGZyb21EYXRlPT1udWxsfHxmcm9tRGF0ZS5lcXVhbHMoIiIpKXsNCiAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCLXmS4g16TXqteZ15fXlCAiK3RvLHN1bURDVUFNLnRvU3RyaW5nKCksIiIsc3VtREFDQU0udG9TdHJpbmcoKSxzdW1EVENBTS50b1N0cmluZygpLHN1bUNDVUFNLnRvU3RyaW5nKCksc3VtQ0FDQU0udG9TdHJpbmcoKSxzdW1DVENBTS50b1N0cmluZygpLHN1bVRvdGFsQ1VBTS50b1N0cmluZygpLHN1bVRvdGFsQUNBTS50b1N0cmluZygpLHN1bVRvdGFsVENBTS50b1N0cmluZygpKTsNCiAgICAgICAgIA0KICAgICAgICAgIGhhc09wZW5MaW5lPXRydWU7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZihJbnRlZ2VyLnBhcnNlSW50KHJlc3VsdC5nZXQoIkFDRFQiKSk+PUludGVnZXIucGFyc2VJbnQoZnJvbURhdGUpKXsNCiAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCLXmS4g16TXqteZ15fXlCAiK3RvLHN1bURDVUFNLnRvU3RyaW5nKCksItec16rXkNeo15nXmiAiK2Zyb21EYXRlLHN1bURBQ0FNLnRvU3RyaW5nKCksc3VtRFRDQU0udG9TdHJpbmcoKSxzdW1DQ1VBTS50b1N0cmluZygpLHN1bUNBQ0FNLnRvU3RyaW5nKCksc3VtQ1RDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbENVQU0udG9TdHJpbmcoKSxzdW1Ub3RhbEFDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbFRDQU0udG9TdHJpbmcoKSk7DQogICAgICAgICAgaGFzT3BlbkxpbmU9dHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgc3VtVG90YWxDVUFNPShzdW1Ub3RhbENVQU0uYWRkKG5ldyBCaWdEZWNpbWFsKHJlc3VsdC5nZXQoIkNVQU0iKSkpKTsNCiAgICAgIHN1bVRvdGFsQUNBTT0oc3VtVG90YWxBQ0FNLmFkZChuZXcgQmlnRGVjaW1hbChyZXN1bHQuZ2V0KCJBQ0FNIikpKSk7DQogICAgICBzdW1Ub3RhbFRDQU09KHN1bVRvdGFsVENBTS5hZGQobmV3IEJpZ0RlY2ltYWwocmVzdWx0LmdldCgiVENBTSIpKSkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgaWYocmVzdWx0LmdldCgiREJDUiIpLmVxdWFscygiRCIpKXsNCiAgICAgICAgc3VtRENVQU09KHN1bURDVUFNLmFkZChuZXcgQmlnRGVjaW1hbChyZXN1bHQuZ2V0KCJDVUFNIikpKSk7DQogICAgICAgIHN1bURBQ0FNPShzdW1EQUNBTS5hZGQobmV3IEJpZ0RlY2ltYWwocmVzdWx0LmdldCgiQUNBTSIpKSkpOw0KICAgICAgICBzdW1EVENBTT0oc3VtRFRDQU0uYWRkKG5ldyBCaWdEZWNpbWFsKHJlc3VsdC5nZXQoIlRDQU0iKSkpKTsNCiAgICAgICAgTGluZURDVUFNPXJlc3VsdC5nZXQoIkNVQU0iKTsNCiAgICAgICAgTGluZURBQ0FNPXJlc3VsdC5nZXQoIkFDQU0iKTsNCiAgICAgICAgTGluZURUQ0FNPXJlc3VsdC5nZXQoIlRDQU0iKTsNCiAgICAgICAgTGluZUNDVUFNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgTGluZUNBQ0FNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgTGluZUNUQ0FNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgIH0NCiAgICAgIGVsc2UgaWYocmVzdWx0LmdldCgiREJDUiIpLmVxdWFscygiQyIpKXsNCiAgICAgICAgc3VtQ0NVQU09KHN1bUNDVUFNLmFkZChuZXcgQmlnRGVjaW1hbChyZXN1bHQuZ2V0KCJDVUFNIikpKSk7DQogICAgICAgIHN1bUNBQ0FNPShzdW1DQUNBTS5hZGQobmV3IEJpZ0RlY2ltYWwocmVzdWx0LmdldCgiQUNBTSIpKSkpOw0KICAgICAgICBzdW1DVENBTT0oc3VtQ1RDQU0uYWRkKG5ldyBCaWdEZWNpbWFsKHJlc3VsdC5nZXQoIlRDQU0iKSkpKTsNCiAgICAgICAgTGluZURDVUFNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgTGluZURBQ0FNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgTGluZURUQ0FNPUJpZ0RlY2ltYWwuWkVSTzsNCiAgICAgICAgTGluZUNDVUFNPXJlc3VsdC5nZXQoIkNVQU0iKTsNCiAgICAgICAgTGluZUNBQ0FNPXJlc3VsdC5nZXQoIkFDQU0iKTsNCiAgICAgICAgTGluZUNUQ0FNPXJlc3VsdC5nZXQoIlRDQU0iKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgaWYocmVzdWx0TGlzdC5zaXplKCk9PShjbnRMaW5lcysxKSl7DQogICAgICAgIGlmKGZyb21EYXRlIT1udWxsJiYhZnJvbURhdGUuZXF1YWxzKCIiKSl7DQogICAgICAgICAgaWYoSW50ZWdlci5wYXJzZUludChyZXN1bHQuZ2V0KCJBQ0RUIikpPj1JbnRlZ2VyLnBhcnNlSW50KGZyb21EYXRlKSl7DQogICAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCIiLExpbmVEQ1VBTS50b1N0cmluZygpLCIiLExpbmVEQUNBTS50b1N0cmluZygpLExpbmVEVENBTS50b1N0cmluZygpLExpbmVDQ1VBTS50b1N0cmluZygpLExpbmVDQUNBTS50b1N0cmluZygpLExpbmVDVENBTS50b1N0cmluZygpLHN1bVRvdGFsQ1VBTS50b1N0cmluZygpLHN1bVRvdGFsQUNBTS50b1N0cmluZygpLHN1bVRvdGFsVENBTS50b1N0cmluZygpKTsNCiAgICAgICAgICB9DQogICAgICAgICAgZWxzZXsNCiAgICAgICAgICAgIHByaW50T3V0TGluZShyZXN1bHQsIteZLiDXpNeq15nXl9eUICIrdG8sc3VtRENVQU0udG9TdHJpbmcoKSwi15zXqteQ16jXmdeaICIrZnJvbURhdGUsc3VtREFDQU0udG9TdHJpbmcoKSxzdW1EVENBTS50b1N0cmluZygpLHN1bUNDVUFNLnRvU3RyaW5nKCksc3VtQ0FDQU0udG9TdHJpbmcoKSxzdW1DVENBTS50b1N0cmluZygpLHN1bVRvdGFsQ1VBTS50b1N0cmluZygpLHN1bVRvdGFsQUNBTS50b1N0cmluZygpLHN1bVRvdGFsVENBTS50b1N0cmluZygpKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWxzZXsNCiAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCIiLExpbmVEQ1VBTS50b1N0cmluZygpLCIiLExpbmVEQUNBTS50b1N0cmluZygpLExpbmVEVENBTS50b1N0cmluZygpLExpbmVDQ1VBTS50b1N0cmluZygpLExpbmVDQUNBTS50b1N0cmluZygpLExpbmVDVENBTS50b1N0cmluZygpLHN1bVRvdGFsQ1VBTS50b1N0cmluZygpLHN1bVRvdGFsQUNBTS50b1N0cmluZygpLHN1bVRvdGFsVENBTS50b1N0cmluZygpKTsNCiAgICAgICAgfQ0KICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCLXmS4g16HXkteZ16jXlCAiK3RvLHN1bURDVUFNLnRvU3RyaW5nKCksItec16rXkNeo15nXmiAiK3RvRGF0ZSxzdW1EQUNBTS50b1N0cmluZygpLHN1bURUQ0FNLnRvU3RyaW5nKCksc3VtQ0NVQU0udG9TdHJpbmcoKSxzdW1DQUNBTS50b1N0cmluZygpLHN1bUNUQ0FNLnRvU3RyaW5nKCksc3VtVG90YWxDVUFNLnRvU3RyaW5nKCksc3VtVG90YWxBQ0FNLnRvU3RyaW5nKCksc3VtVG90YWxUQ0FNLnRvU3RyaW5nKCkpOw0KICAgICAgfQ0KDQogICAgICBlbHNlIGlmKGZyb21EYXRlIT1udWxsJiYhZnJvbURhdGUuZXF1YWxzKCIiKSl7DQogICAgICAgIGlmKEludGVnZXIucGFyc2VJbnQocmVzdWx0LmdldCgiQUNEVCIpKTxJbnRlZ2VyLnBhcnNlSW50KGZyb21EYXRlKSYmSW50ZWdlci5wYXJzZUludChyZXN1bHRMaXN0LmdldChjbnRMaW5lcysxKS5nZXQoIkFDRFQiKSk+PUludGVnZXIucGFyc2VJbnQoZnJvbURhdGUpKXsNCiAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCLXmS4g16TXqteZ15fXlCAiK3RvLHN1bURDVUFNLnRvU3RyaW5nKCksItec16rXkNeo15nXmiAiK2Zyb21EYXRlLHN1bURBQ0FNLnRvU3RyaW5nKCksc3VtRFRDQU0udG9TdHJpbmcoKSxzdW1DQ1VBTS50b1N0cmluZygpLHN1bUNBQ0FNLnRvU3RyaW5nKCksc3VtQ1RDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbENVQU0udG9TdHJpbmcoKSxzdW1Ub3RhbEFDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbFRDQU0udG9TdHJpbmcoKSk7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZihJbnRlZ2VyLnBhcnNlSW50KHJlc3VsdC5nZXQoIkFDRFQiKSk+PUludGVnZXIucGFyc2VJbnQoZnJvbURhdGUpKXsNCiAgICAgICAgICBwcmludE91dExpbmUocmVzdWx0LCIiLExpbmVEQ1VBTS50b1N0cmluZygpLCIiLExpbmVEQUNBTS50b1N0cmluZygpLExpbmVEVENBTS50b1N0cmluZygpLExpbmVDQ1VBTS50b1N0cmluZygpLExpbmVDQUNBTS50b1N0cmluZygpLExpbmVDVENBTS50b1N0cmluZygpLHN1bVRvdGFsQ1VBTS50b1N0cmluZygpLHN1bVRvdGFsQUNBTS50b1N0cmluZygpLHN1bVRvdGFsVENBTS50b1N0cmluZygpKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgZWxzZXsNCiAgICAgICAgcHJpbnRPdXRMaW5lKHJlc3VsdCwiIixMaW5lRENVQU0udG9TdHJpbmcoKSwiIixMaW5lREFDQU0udG9TdHJpbmcoKSxMaW5lRFRDQU0udG9TdHJpbmcoKSxMaW5lQ0NVQU0udG9TdHJpbmcoKSxMaW5lQ0FDQU0udG9TdHJpbmcoKSxMaW5lQ1RDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbENVQU0udG9TdHJpbmcoKSxzdW1Ub3RhbEFDQU0udG9TdHJpbmcoKSxzdW1Ub3RhbFRDQU0udG9TdHJpbmcoKSk7DQogICAgICB9DQogICAgfQ0KICB9DQogIA0KICAgDQogIA0KICAgU3RyaW5nIHJvdW5kKFN0cmluZyB2YWx1ZSwgaW50IHBsYWNlcykgew0KICAgICAgICBkb3VibGUgdmFsPURvdWJsZS52YWx1ZU9mKHZhbHVlKTsNCiAgICAgICAgQmlnRGVjaW1hbCBiZCA9IG5ldyBCaWdEZWNpbWFsKHZhbCkuc2V0U2NhbGUocGxhY2VzLCBSb3VuZGluZ01vZGUuSEFMRl9VUCk7DQogICAgICAgIHJldHVybiBiZC50b1N0cmluZygpOw0KICAgIH0NCiAgICANCiAgICB2b2lkIHNvcnRUYWJsZShMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+IGxpc3QsU3RyaW5nIGZpZWxkKXsNCiAgICAgIA0KICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBsaXN0LnNpemUoKSAtIDE7IGkrKykgew0KICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBsaXN0LnNpemUoKSAtIGkgLSAxOyBqKyspIHsNCiAgICAgICAgICAgICAgICBJbnRlZ2VyIGFjZHQxID0gSW50ZWdlci5wYXJzZUludChsaXN0LmdldChqKS5nZXQoZmllbGQpKTsNCiAgICAgICAgICAgICAgICBJbnRlZ2VyIGFjZHQyID0gIEludGVnZXIucGFyc2VJbnQoIGxpc3QuZ2V0KGogKyAxKS5nZXQoZmllbGQpKTsNCg0KICAgICAgICAgICAgICAgIGlmIChhY2R0MSA+IGFjZHQyKSB7IC8vIFN3YXAgaWYgdGhlIGZpcnN0IGlzIGdyZWF0ZXINCiAgICAgICAgICAgICAgICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiB0ZW1wID0gbGlzdC5nZXQoaik7DQogICAgICAgICAgICAgICAgICAgIGxpc3Quc2V0KGosIGxpc3QuZ2V0KGogKyAxKSk7DQogICAgICAgICAgICAgICAgICAgIGxpc3Quc2V0KGogKyAxLCB0ZW1wKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgfQ0KICAgIH0NCiAgICANCiAgIA0KICAgIHZvaWQgYnViYmxlU29ydChMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+IGxpc3QsIFN0cmluZyBrZXkxKSB7DQogICAgICAgIGludCBuID0gbGlzdC5zaXplKCk7DQogICAgICAgIGJvb2xlYW4gc3dhcHBlZDsNCg0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG4gLSAxOyBpKyspIHsNCiAgICAgICAgICAgIHN3YXBwZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBuIC0gaSAtIDE7IGorKykgew0KICAgICAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gbWFwMSA9IGxpc3QuZ2V0KGopOw0KICAgICAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gbWFwMiA9IGxpc3QuZ2V0KGogKyAxKTsNCg0KICAgICAgICAgICAgICAgIFN0cmluZyB2YWwxS2V5MSA9IG1hcDEuZ2V0KGtleTEpOyAvLyB4IGFzIHN0cmluZw0KICAgICAgICAgICAgICAgIFN0cmluZyB2YWwyS2V5MSA9IG1hcDIuZ2V0KGtleTEpOyAvLyB4IGFzIHN0cmluZw0KDQogICAgICAgICAgICAgICAgLy8gQ29tcGFyZSB4IGFscGhhYmV0aWNhbGx5DQogICAgICAgICAgICAgICAgaWYgKHZhbDFLZXkxLmNvbXBhcmVUbyh2YWwyS2V5MSkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFN3YXAgZWxlbWVudHMNCiAgICAgICAgICAgICAgICAgICAgQ29sbGVjdGlvbnMuc3dhcChsaXN0LCBqLCBqICsgMSk7DQogICAgICAgICAgICAgICAgICAgIHN3YXBwZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCFzd2FwcGVkKSBicmVhazsgLy8gT3B0aW1pemF0aW9uOiBTdG9wIGlmIG5vIHN3YXBzDQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgU3RyaW5nIGdldEN1cnJlbnREYXRlKCl7DQogICAgICAgIERhdGUgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICBTaW1wbGVEYXRlRm9ybWF0IHNkZiA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KCJ5eXl5TU1kZCIpOw0KICAgICAgICBTdHJpbmcgZm9ybWF0dGVkRGF0ZSA9IHNkZi5mb3JtYXQoY3VycmVudERhdGUpOw0KICAgICAgICByZXR1cm4gZm9ybWF0dGVkRGF0ZTsNCiAgICB9DQogICAgDQogICAgdm9pZCBwcmludE91dExpbmUoTWFwPFN0cmluZyxTdHJpbmc+IGN1ckxpbmUsU3RyaW5nIHN1bUxpbmVOYW1lLFN0cmluZyBzdW1EQ1VBTSxTdHJpbmcgc3VtTGluZURlc2MsU3RyaW5nIHN1bURBQ0FNLFN0cmluZyBzdW1EVENBTSxTdHJpbmcgc3VtQ0NVQU0NCiAgICAsU3RyaW5nIHN1bUNBQ0FNLFN0cmluZyBzdW1DVENBTSxTdHJpbmcgc3VtVG90YWxDVUFNLFN0cmluZyBzdW1Ub3RhbEFDQU0sU3RyaW5nIHN1bVRvdGFsVENBTSl7DQogICAgICBtaS5vdXREYXRhLnB1dCgiQ09OTyIsIGN1ckxpbmUuZ2V0KCJDT05PIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkRJVkkiLCBjdXJMaW5lLmdldCgiRElWSSIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJQWU5PIiwgaXNQYXllciYmIWlzRnJvbUN1c3QmJiFzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJQWU5PIik6IiIpOw0KICAgICAgLy9taS5vdXREYXRhLnB1dCgiQ1VOTyIsIGlzRnJvbUN1c3R8fCFzdW1MaW5lTmFtZS5lcXVhbHMoIiIpPyIiOmN1ckxpbmUuZ2V0KCJDVU5PIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkNVTk8iLCBpc1BheWVyJiYhaXNGcm9tQ3VzdCYmc3VtTGluZU5hbWUuZXF1YWxzKCIiKXx8aXNGcm9tQ3VzdCYmIXN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIkNVTk8iKToiIik7DQogICAgICBtaS5vdXREYXRhLnB1dCgiVFgxNSIsIChzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJUWDE1Iik6c3VtTGluZU5hbWUpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJWT05PIiwgKHN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIlZPTk8iKToiIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkFDRFQiLCAoc3VtTGluZU5hbWUuZXF1YWxzKCIiKT9jdXJMaW5lLmdldCgiQUNEVCIpOiIiKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiT0NEVCIsIChzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJPQ0RUIik6IiIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJEQkNSIiwgKHN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIkRCQ1IiKToiIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkRVRFQiLCAoc3VtTGluZU5hbWUuZXF1YWxzKCIiKT9jdXJMaW5lLmdldCgiRFVEVCIpOiIiKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiRENVQSIsIHJvdW5kKHN1bURDVUFNLnRvU3RyaW5nKCksMikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkRBQ0EiLCByb3VuZChzdW1EQUNBTS50b1N0cmluZygpLDIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJEVENBIiwgcm91bmQoc3VtRFRDQU0udG9TdHJpbmcoKSwyKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiQ0NVQSIsIHJvdW5kKHN1bUNDVUFNLnRvU3RyaW5nKCksMikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkNBQ0EiLCByb3VuZChzdW1DQUNBTS50b1N0cmluZygpLDIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJDVENBIiwgcm91bmQoc3VtQ1RDQU0udG9TdHJpbmcoKSwyKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiQVJBVCIsIChzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJBUkFUIik6IiIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJUQ0FSIiwgKHN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIlRDQVIiKToiIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIlBZUlMiLCAoc3VtTGluZU5hbWUuZXF1YWxzKCIiKT9jdXJMaW5lLmdldCgiUFlSUyIpOiIiKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiSVZUUCIsIChzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJJVlRQIik6IiIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJUUkNEIiwgKHN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIlRSQ0QiKToiIikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIkZFSUQiLCAoc3VtTGluZU5hbWUuZXF1YWxzKCIiKT9jdXJMaW5lLmdldCgiRkVJRCIpOiIiKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiRk5DTiIsIChzdW1MaW5lTmFtZS5lcXVhbHMoIiIpP2N1ckxpbmUuZ2V0KCJGTkNOIik6IiIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJSRUZFIiwgKHN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIlJFRkUiKToiIikpOw0KICAgICAgLy8gbWkub3V0RGF0YS5wdXQoIlZUWFQiLCBzdW1MaW5lRGVzYyk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiVlRYVCIsIGN1ckxpbmUuZ2V0KCJWVFhUIikgPT0gbnVsbCA/ICAiIiA6ICBjdXJMaW5lLmdldCgiVlRYVCIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJUQ1VBIiwgcm91bmQoc3VtVG90YWxDVUFNLnRvU3RyaW5nKCksMikpOw0KICAgICAgbWkub3V0RGF0YS5wdXQoIlRBQ0EiLCByb3VuZChzdW1Ub3RhbEFDQU0udG9TdHJpbmcoKSwyKSk7DQogICAgICBtaS5vdXREYXRhLnB1dCgiVFRDQSIsIHJvdW5kKHN1bVRvdGFsVENBTS50b1N0cmluZygpLDIpKTsNCiAgICAgIC8vbWkub3V0RGF0YS5wdXQoIkNVTk0iLCBpc0Zyb21DdXN0fHwhc3VtTGluZU5hbWUuZXF1YWxzKCIiKT8iIjpjdXJMaW5lLmdldCgiQ1VOTSIpKTsNCiAgICAgIG1pLm91dERhdGEucHV0KCJDVU5NIixpc1BheWVyJiYhaXNGcm9tQ3VzdCYmc3VtTGluZU5hbWUuZXF1YWxzKCIiKXx8aXNGcm9tQ3VzdCYmIXN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIkNVTk0iKToiIik7DQogICAgICBtaS5vdXREYXRhLnB1dCgiQ1VDRCIsIGN1ckxpbmUuZ2V0KCJDVUNEIikpOw0KICAgICAgLy8gbWkub3V0RGF0YS5wdXQoIlBZTk0iLCBpc1BheWVyJiYhaXNGcm9tQ3VzdCYmIXN1bUxpbmVOYW1lLmVxdWFscygiIik/Y3VyTGluZS5nZXQoIlBZTk0iKToiIik7DQogICAgICBtaS5vdXREYXRhLnB1dCgiUFlOTSIsIGlzUGF5ZXImJiFpc0Zyb21DdXN0JiYhc3VtTGluZU5hbWUuZXF1YWxzKCIiKT8oY3VyTGluZS5nZXQoIlBZTk0iKSAhPSBudWxsID8gY3VyTGluZS5nZXQoIlBZTk0iKSA6ICIiKToiIik7DQogICAgICBtaS53cml0ZSgpOw0KICAgIH0NCiAgICANCiAgDQogIHZvaWQgcmVhZFJlY29yZHNGU0xFREcoKSB7DQogICAgaW50IG5yT2ZLZXlzID0gMDsNCiAgICAvL2ludCBuck9mUmVjb3JkcyA9IG1pLmdldE1heFJlY29yZHMoKSA8PSAwIHx8IG1pLmdldE1heFJlY29yZHMoKSA+PSAxMDAwMD8gMTAwMDA6IG1pLmdldE1heFJlY29yZHMoKTsgDQogICAgaW50IG5yT2ZSZWNvcmRzPTk5OTk7DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbkZTTEVERyA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJGU0xFREciKTsNCiAgICAvKmlmKGlzRnJvbUN1c3QmJmlzVG9DdXN0KXsNCiAgICAgICBleHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuZ2UoIkVTUFlOTyIsZnJvbUN1c3RvbWVyKS5hbmQoZXhwcmVzc2lvbkZTTEVERy5sZSgiRVNQWU5PIix0b0N1c3RvbWVyKSk7DQogICAgfQ0KICAgIGVsc2V7DQogICAgICBTdHJpbmcgY3VzdD1pc1RvQ3VzdCA/IHRvQ3VzdG9tZXIgOiBmcm9tQ3VzdG9tZXI7DQogICAgICBleHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuZXEoIkVTUFlOTyIsY3VzdCk7DQogICAgfSovDQogICAgaWYoaXNQYXllcil7DQogICAgICBpZighaXNGcm9tQ3VzdCl7DQogICAgICAgICBleHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuZXEoIkVTUFlOTyIscGF5ZXIpOw0KICAgICAgICAgZXhwcmVzc2lvbkZTTEVERz1leHByZXNzaW9uRlNMRURHLm9yKGV4cHJlc3Npb25GU0xFREcuZXEoIkVTQ1VOTyIscGF5ZXIpKQ0KICAgICAgfQ0KICAgICAgZWxzZXsNCiAgICAgICAgIGV4cHJlc3Npb25GU0xFREc9ZXhwcmVzc2lvbkZTTEVERy5lcSgiRVNQWU5PIixwYXllcik7DQogICAgICAgICBleHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuYW5kKGV4cHJlc3Npb25GU0xFREcuZXEoIkVTQ1VOTyIsZnJvbUN1c3RvbWVyKSkNCiAgICAgIH0NCiAgICB9DQogICAgZWxzZXsNCiAgICAgIGlmKGlzRnJvbUN1c3QmJmlzVG9DdXN0KXsNCiAgICAgICAgZXhwcmVzc2lvbkZTTEVERz1leHByZXNzaW9uRlNMRURHLmdlKCJFU0NVTk8iLGZyb21DdXN0b21lcikuYW5kKGV4cHJlc3Npb25GU0xFREcubGUoIkVTQ1VOTyIsdG9DdXN0b21lcikpOw0KICAgICAgfQ0KICAgICAgZWxzZSBpZihpc0Zyb21DdXN0KXsNCiAgICAgICAgZXhwcmVzc2lvbkZTTEVERz1leHByZXNzaW9uRlNMRURHLmVxKCJFU0NVTk8iLGZyb21DdXN0b21lcik7DQogICAgICB9DQogICAgICBlbHNlIGlmKGlzVG9DdXN0KQ0KICAgICAgIGV4cHJlc3Npb25GU0xFREc9ZXhwcmVzc2lvbkZTTEVERy5lcSgiRVNDVU5PIix0b0N1c3RvbWVyKTsNCiAgICB9DQogICAgLy9leHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuZXEoIkVTUFlOTyIscGF5ZXIpOw0KICAgIC8vZXhwcmVzc2lvbkZTTEVERz1leHByZXNzaW9uRlNMRURHLmFuZChleHByZXNzaW9uRlNMRURHLmdlKCJFU0NVTk8iLGZyb21DdXN0b21lcikuYW5kKGV4cHJlc3Npb25GU0xFREcubGUoIkVTQ1VOTyIsdG9DdXN0b21lcikpKTsNCiAgICAvL2V4cHJlc3Npb25GU0xFREcgPSBleHByZXNzaW9uRlNMRURHLmFuZChleHByZXNzaW9uRlNMRURHLm5lKCJFU0lWVFAiLCJBUCIpKTsNCiAgICBleHByZXNzaW9uRlNMRURHPWV4cHJlc3Npb25GU0xFREcuYW5kKGV4cHJlc3Npb25GU0xFREcuZXEoIkVTUFlSUyIsIiIpLm9yKGV4cHJlc3Npb25GU0xFREcubHQoIkVTUFlSUyIsIjcwIikpKTsNCiAgICBEQkFjdGlvbiBxdWVyeUZTTEVERyA9IGRhdGFiYXNlLnRhYmxlKCJGU0xFREciKQ0KICAgICAgLmluZGV4KCIwMCIpDQogICAgICAubWF0Y2hpbmcoZXhwcmVzc2lvbkZTTEVERykNCiAgICAgIC5zZWxlY3Rpb24oIkVTQ09OTyIsICJFU0RJVkkiLCAiRVNQWU5PIiwgIkVTQ1VOTyIsICJFU1ZTRVIiLCJFU1ZPTk8iLCJFU0FDRFQiLCJFU0NVQU0iLCJFU0RVRFQiLCJFU0lWVFAiLCJFU0NJTk8iLCJFU1BZUlMiLCJFU1lFQTQiLCJFU0pSTk8iLCJFU0pTTk8iLCJFU0NVQ0QiKQ0KICAgICAgLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyRlNMRURHID0gcXVlcnlGU0xFREcuZ2V0Q29udGFpbmVyKCk7DQogICAgcXVlcnlGU0xFREcucmVhZEFsbChjb250YWluZXJGU0xFREcsIG5yT2ZLZXlzLCBuck9mUmVjb3JkcywgY2FsbGJhY2tGU0xFREcpDQogICAgDQogIH0NCiAgDQogIHZvaWQgcmVhZFJlY29yZHNGR0xFREcoKSB7DQogICAgaW50IG5yT2ZLZXlzID0gMDsNCiAgICAvL2ludCBuck9mUmVjb3JkcyA9IG1pLmdldE1heFJlY29yZHMoKSA8PSAwIHx8IG1pLmdldE1heFJlY29yZHMoKSA+PSAxMDAwMD8gMTAwMDA6IG1pLmdldE1heFJlY29yZHMoKTsgDQogICAgaW50IG5yT2ZSZWNvcmRzPTk5OTk7DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbkZHTEVERyA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJGR0xFREciKTsNCiAgICBleHByZXNzaW9uRkdMRURHID0gZXhwcmVzc2lvbkZHTEVERy5lcSgiRUdUUkNEIiwiMTAiKS5vcihleHByZXNzaW9uRkdMRURHLmVxKCJFR1RSQ0QiLCIyMCIpKTsNCiAgICAvL2V4cHJlc3Npb25GR0xFREc9ZXhwcmVzc2lvbkZHTEVERy5hbmQoZXhwcmVzc2lvbkZHTEVERy5nZSgiRUdBQ0RUIixmcm9tRGF0ZSkpLmFuZChleHByZXNzaW9uRkdMRURHLmxlKCJFR0FDRFQiLHRvRGF0ZSkpOw0KICAgIGV4cHJlc3Npb25GR0xFREc9ZXhwcmVzc2lvbkZHTEVERy5hbmQoZXhwcmVzc2lvbkZHTEVERy5sZSgiRUdBQ0RUIix0b0RhdGUpKTsNCiAgICBEQkFjdGlvbiBxdWVyeUZHTEVERyA9IGRhdGFiYXNlLnRhYmxlKCJGR0xFREciKQ0KICAgICAgLmluZGV4KCIwMCIpDQogICAgICAubWF0Y2hpbmcoZXhwcmVzc2lvbkZHTEVERykNCiAgICAgIC5zZWxlY3Rpb24oIkVHT0NEVCIsICJFR1RSQ0QiLCAiRUdWVFhUIiwgIkVHQUNBTSIsICJFR0FSQVQiLCJFR1RDQU0iLCJFR1RDQVIiLCJFR0NPTk8iLCJFR0RJVkkiLCJFR1lFQTQiLCJFR0pSTk8iLCJFR0pTTk8iLCJFR0ZOQ04iLCJFR0ZFSUQiLCJFR0RCQ1IiKQ0KICAgICAgLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyRkdMRURHID0gcXVlcnlGR0xFREcuZ2V0Q29udGFpbmVyKCk7DQogICAgcXVlcnlGR0xFREcucmVhZEFsbChjb250YWluZXJGR0xFREcsIG5yT2ZLZXlzLCBuck9mUmVjb3JkcywgY2FsbGJhY2tGR0xFREcpDQogICAgDQogIH0NCiAgDQogIHZvaWQgcmVhZFJlY29yZHNGRFJGTUEoKSB7DQogICAgaW50IG5yT2ZLZXlzID0gMDsNCiAgICAvL2ludCBuck9mUmVjb3JkcyA9IG1pLmdldE1heFJlY29yZHMoKSA8PSAwIHx8IG1pLmdldE1heFJlY29yZHMoKSA+PSAxMDAwMD8gMTAwMDA6IG1pLmdldE1heFJlY29yZHMoKTsNCiAgICBpbnQgbnJPZlJlY29yZHM9OTk5OTsNCiAgICBEQkFjdGlvbiBxdWVyeUZEUkZNQSA9IGRhdGFiYXNlLnRhYmxlKCJGRFJGTUEiKQ0KICAgICAgLmluZGV4KCIwMCIpDQogICAgICAuc2VsZWN0aW9uKCJETURSUk4iLCAiRE1EVURUIiwgIkRNQ09OTyIsICJETURJVkkiLCAiRE1DSU5PIikNCiAgICAgIC5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lckZEUkZNQSA9IHF1ZXJ5RkRSRk1BLmdldENvbnRhaW5lcigpOw0KICAgIHF1ZXJ5RkRSRk1BLnJlYWRBbGwoY29udGFpbmVyRkRSRk1BLCBuck9mS2V5cywgbnJPZlJlY29yZHMsIGNhbGxiYWNrRkRSRk1BKQ0KICB9DQogIA0KICB2b2lkIHJlYWRSZWNvcmRzQ1NZTkJWKCkgew0KICAgIGludCBuck9mS2V5cyA9IDA7DQogICAgLy9pbnQgbnJPZlJlY29yZHMgPSBtaS5nZXRNYXhSZWNvcmRzKCkgPD0gMCB8fCBtaS5nZXRNYXhSZWNvcmRzKCkgPj0gMTAwMDA/IDEwMDAwOiBtaS5nZXRNYXhSZWNvcmRzKCk7DQogICAgaW50IG5yT2ZSZWNvcmRzPTk5OTk7DQogICAgREJBY3Rpb24gcXVlcnlDU1lOQlYgPSBkYXRhYmFzZS50YWJsZSgiQ1NZTkJWIikNCiAgICAgIC5pbmRleCgiMDAiKQ0KICAgICAgLnNlbGVjdGlvbigiRFZUWDE1IiwiRFZDT05PIiwiRFZESVZJIiwiRFZWU0VSIikNCiAgICAgIC5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lckNTWU5CViA9IHF1ZXJ5Q1NZTkJWLmdldENvbnRhaW5lcigpOw0KICAgIHF1ZXJ5Q1NZTkJWLnJlYWRBbGwoY29udGFpbmVyQ1NZTkJWLCBuck9mS2V5cywgbnJPZlJlY29yZHMsIGNhbGxiYWNrQ1NZTkJWKQ0KICB9DQogIA0KICB2b2lkIHJlYWRSZWNvcmRzT0NVU01BKFN0cmluZyBjb25vLCBTdHJpbmcgY3Vubykgew0KICAgIGludCBuck9mS2V5cyA9IDA7DQogICAgLy9pbnQgbnJPZlJlY29yZHMgPSBtaS5nZXRNYXhSZWNvcmRzKCkgPD0gMCB8fCBtaS5nZXRNYXhSZWNvcmRzKCkgPj0gMTAwMDA/IDEwMDAwOiBtaS5nZXRNYXhSZWNvcmRzKCk7DQogICAgaW50IG5yT2ZSZWNvcmRzPTk5OTk7DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbk9DVVNNQSA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJPQ1VTTUEiKTsNCiAgICBleHByZXNzaW9uT0NVU01BID0gZXhwcmVzc2lvbk9DVVNNQS5lcSgiT0tDT05PIixjb25vKTsNCiAgICBleHByZXNzaW9uT0NVU01BID0gZXhwcmVzc2lvbk9DVVNNQS5hbmQoZXhwcmVzc2lvbk9DVVNNQS5lcSgiT0tDVU5PIixjdW5vKSk7DQogICAgREJBY3Rpb24gcXVlcnlPQ1VTTUEgPSBkYXRhYmFzZS50YWJsZSgiT0NVU01BIikNCiAgICAgIC5pbmRleCgiMDAiKQ0KICAgICAgLm1hdGNoaW5nKGV4cHJlc3Npb25PQ1VTTUEpDQogICAgICAuc2VsZWN0aW9uKCJPS0NVTk8iLCJPS0NVTk0iLCJPS0NPTk8iKQ0KICAgICAgLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyT0NVU01BID0gcXVlcnlPQ1VTTUEuZ2V0Q29udGFpbmVyKCk7DQogICAgcXVlcnlPQ1VTTUEucmVhZEFsbChjb250YWluZXJPQ1VTTUEsIG5yT2ZLZXlzLCBuck9mUmVjb3JkcywgY2FsbGJhY2tPQ1VTTUEpOw0KICB9DQogIA0KICBDbG9zdXJlPD8+IGNhbGxiYWNrT0NVU01BID0geyBEQkNvbnRhaW5lciBjb250YWluZXIgLT4NCiAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IGN1clJvdz1uZXcgSGFzaE1hcDw+KCk7DQogICAgY3VyUm93LnB1dCgiQ1VOTyIsY29udGFpbmVyLmdldCgiT0tDVU5PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiT0tDVU5PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkNVTk0iLGNvbnRhaW5lci5nZXQoIk9LQ1VOTSIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIk9LQ1VOTSIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJDT05PIixjb250YWluZXIuZ2V0KCJPS0NPTk8iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJPS0NPTk8iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiUFlOTyIsY29udGFpbmVyLmdldCgiT0tQWU5PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiT0tQWU5PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIG9jdXNtYUxpc3QuYWRkKGN1clJvdyk7DQogICAgDQogIH0NCiAgDQogIENsb3N1cmU8Pz4gY2FsbGJhY2tGU0xFREcgPSB7IERCQ29udGFpbmVyIGNvbnRhaW5lciAtPg0KICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gY3VyUm93PW5ldyBIYXNoTWFwPD4oKTsNCiAgICBjdXJSb3cucHV0KCJDT05PIixjb250YWluZXIuZ2V0KCJFU0NPTk8iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU0NPTk8iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiRElWSSIsY29udGFpbmVyLmdldCgiRVNESVZJIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRVNESVZJIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIlBZTk8iLGNvbnRhaW5lci5nZXQoIkVTUFlOTyIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVTUFlOTyIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJDVU5PIixjb250YWluZXIuZ2V0KCJFU0NVTk8iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU0NVTk8iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiVlNFUiIsY29udGFpbmVyLmdldCgiRVNWU0VSIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRVNWU0VSIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIlZPTk8iLGNvbnRhaW5lci5nZXQoIkVTVk9OTyIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVTVk9OTyIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJBQ0RUIixjb250YWluZXIuZ2V0KCJFU0FDRFQiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU0FDRFQiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiQ1VBTSIsY29udGFpbmVyLmdldCgiRVNDVUFNIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRVNDVUFNIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkRVRFQiLGNvbnRhaW5lci5nZXQoIkVTRFVEVCIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVTRFVEVCIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJJVlRQIixjb250YWluZXIuZ2V0KCJFU0lWVFAiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU0lWVFAiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiQ0lOTyIsY29udGFpbmVyLmdldCgiRVNDSU5PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRVNDSU5PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIlBZUlMiLGNvbnRhaW5lci5nZXQoIkVTUFlSUyIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVTUFlSUyIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJZRUE0Iixjb250YWluZXIuZ2V0KCJFU1lFQTQiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU1lFQTQiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiSlJOTyIsY29udGFpbmVyLmdldCgiRVNKUk5PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRVNKUk5PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkpTTk8iLGNvbnRhaW5lci5nZXQoIkVTSlNOTyIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVTSlNOTyIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJDVUNEIixjb250YWluZXIuZ2V0KCJFU0NVQ0QiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFU0NVQ0QiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgZnNsZWRnTGlzdC5hZGQoY3VyUm93KTsNCiAgICByZWFkUmVjb3Jkc09DVVNNQShjdXJSb3cuZ2V0KCJDT05PIiksY3VyUm93LmdldCgiQ1VOTyIpKTsNCiAgICByZWFkUmVjb3Jkc09DVVNNQShjdXJSb3cuZ2V0KCJDT05PIiksY3VyUm93LmdldCgiUFlOTyIpKTsNCiAgICANCiAgfQ0KICANCiAgQ2xvc3VyZTw/PiBjYWxsYmFja0ZHTEVERyA9IHsgREJDb250YWluZXIgY29udGFpbmVyIC0+DQogICAgTWFwPFN0cmluZywgU3RyaW5nPiBjdXJSb3c9bmV3IEhhc2hNYXA8PigpOw0KICAgIGN1clJvdy5wdXQoIk9DRFQiLGNvbnRhaW5lci5nZXQoIkVHT0NEVCIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVHT0NEVCIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJUUkNEIixjb250YWluZXIuZ2V0KCJFR1RSQ0QiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFR1RSQ0QiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiVlRYVCIsY29udGFpbmVyLmdldCgiRUdWVFhUIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRUdWVFhUIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkFDQU0iLGNvbnRhaW5lci5nZXQoIkVHQUNBTSIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVHQUNBTSIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJBUkFUIixjb250YWluZXIuZ2V0KCJFR0FSQVQiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFR0FSQVQiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiVENBTSIsY29udGFpbmVyLmdldCgiRUdUQ0FNIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRUdUQ0FNIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIlRDQVIiLGNvbnRhaW5lci5nZXQoIkVHVENBUiIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVHVENBUiIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJDT05PIixjb250YWluZXIuZ2V0KCJFR0NPTk8iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFR0NPTk8iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiRElWSSIsY29udGFpbmVyLmdldCgiRUdESVZJIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRUdESVZJIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIllFQTQiLGNvbnRhaW5lci5nZXQoIkVHWUVBNCIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVHWUVBNCIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJKUk5PIixjb250YWluZXIuZ2V0KCJFR0pSTk8iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFR0pSTk8iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiSlNOTyIsY29udGFpbmVyLmdldCgiRUdKU05PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRUdKU05PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkZOQ04iLGNvbnRhaW5lci5nZXQoIkVHRk5DTiIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkVHRk5DTiIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJGRUlEIixjb250YWluZXIuZ2V0KCJFR0ZFSUQiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJFR0ZFSUQiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiREJDUiIsY29udGFpbmVyLmdldCgiRUdEQkNSIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRUdEQkNSIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGZnbGVkZ0xpc3QuYWRkKGN1clJvdyk7DQogIH0NCiAgDQogIENsb3N1cmU8Pz4gY2FsbGJhY2tGRFJGTUEgPSB7IERCQ29udGFpbmVyIGNvbnRhaW5lciAtPg0KICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gY3VyUm93PW5ldyBIYXNoTWFwPD4oKTsNCiAgICBjdXJSb3cucHV0KCJEUlJOIixjb250YWluZXIuZ2V0KCJETURSUk4iKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJETURSUk4iKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiRFVEVCIsY29udGFpbmVyLmdldCgiRE1EVURUIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRE1EVURUIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkNPTk8iLGNvbnRhaW5lci5nZXQoIkRNQ09OTyIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkRNQ09OTyIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJESVZJIixjb250YWluZXIuZ2V0KCJETURJVkkiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJETURJVkkiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiQ0lOTyIsY29udGFpbmVyLmdldCgiRE1DSU5PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRE1DSU5PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGZkcmZtYUxpc3QuYWRkKGN1clJvdyk7DQogICAgDQogIH0NCiAgDQogIENsb3N1cmU8Pz4gY2FsbGJhY2tDU1lOQlYgPSB7IERCQ29udGFpbmVyIGNvbnRhaW5lciAtPg0KICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gY3VyUm93PW5ldyBIYXNoTWFwPD4oKTsNCiAgICBjdXJSb3cucHV0KCJUWDE1Iixjb250YWluZXIuZ2V0KCJEVlRYMTUiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJEVlRYMTUiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3VyUm93LnB1dCgiQ09OTyIsY29udGFpbmVyLmdldCgiRFZDT05PIik9PW51bGw/IiI6Y29udGFpbmVyLmdldCgiRFZDT05PIikudG9TdHJpbmcoKS50cmltKCkpOw0KICAgIGN1clJvdy5wdXQoIkRJVkkiLGNvbnRhaW5lci5nZXQoIkRWRElWSSIpPT1udWxsPyIiOmNvbnRhaW5lci5nZXQoIkRWRElWSSIpLnRvU3RyaW5nKCkudHJpbSgpKTsNCiAgICBjdXJSb3cucHV0KCJWU0VSIixjb250YWluZXIuZ2V0KCJEVlZTRVIiKT09bnVsbD8iIjpjb250YWluZXIuZ2V0KCJEVlZTRVIiKS50b1N0cmluZygpLnRyaW0oKSk7DQogICAgY3N5bmJ2TGlzdC5hZGQoY3VyUm93KTsNCiAgICANCiAgfQ0KICANCiAgLypMaXN0PE1hcDxTdHJpbmcsIEludGVnZXI+PiBtZXJnZU1hcHMoTGlzdDxTdHJpbmc+IGpvaW5LZXlzLCBMaXN0PExpc3Q8TWFwPFN0cmluZywgSW50ZWdlcj4+PiBsaXN0cykgew0KICAgICAgICBNYXA8U3RyaW5nLCBNYXA8U3RyaW5nLCBJbnRlZ2VyPj4gcmVzdWx0TWFwID0gbmV3IEhhc2hNYXA8PigpOw0KICAgICAgICBmb3IgKExpc3Q8TWFwPFN0cmluZywgSW50ZWdlcj4+IGxpc3QgOiBsaXN0cykgew0KICAgICAgICAgICAgZm9yIChNYXA8U3RyaW5nLCBJbnRlZ2VyPiByb3cgOiBsaXN0KSB7DQogICAgICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBrZXlCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsNCiAgICAgICAgICAgICAgICBmb3IgKFN0cmluZyBqb2luS2V5IDogam9pbktleXMpIHsNCiAgICAgICAgICAgICAgICAgICAga2V5QnVpbGRlci5hcHBlbmQocm93LmdldChqb2luS2V5KSkuYXBwZW5kKCItIik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIFN0cmluZyBrZXkgPSBrZXlCdWlsZGVyLnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAga2V5ID0ga2V5LnN1YnN0cmluZygwLCBrZXkubGVuZ3RoKCkgLSAxKTsNCiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdE1hcC5jb250YWluc0tleShrZXkpKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdE1hcC5wdXQoa2V5LCBuZXcgSGFzaE1hcDxTdHJpbmcsIEludGVnZXI+KCkpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKFN0cmluZyBqb2luS2V5IDogam9pbktleXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1hcC5nZXQoa2V5KS5wdXQoam9pbktleSwgcm93LmdldChqb2luS2V5KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmb3IgKE1hcC5FbnRyeTxTdHJpbmcsIEludGVnZXI+IGVudHJ5IDogcm93LmVudHJ5U2V0KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFqb2luS2V5cy5jb250YWlucyhlbnRyeS5nZXRLZXkoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1hcC5nZXQoa2V5KS5wdXQoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIG5ldyBBcnJheUxpc3Q8PihyZXN1bHRNYXAudmFsdWVzKCkpOw0KICAgIH0qLw0KfQ=="}}}