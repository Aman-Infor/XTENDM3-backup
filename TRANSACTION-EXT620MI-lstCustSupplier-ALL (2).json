{"programModules":{"EXT620MI":{"program":"EXT620MI","triggers":{},"transactions":{"lstCustSupplier":{"sourceUuid":"a070e177-813e-4d2e-8572-e7e0d6da7939","name":"lstCustSupplier","program":"EXT620MI","description":"list of Customers and Suppliers data","active":true,"multi":true,"modified":1763901484826,"modifiedBy":"ERP2024","outputFields":[{"name":"ACDT","description":"accounting date","length":8,"mandatory":false,"type":"D","refField":"ACDT"},{"name":"TX15","description":"name","length":15,"mandatory":false,"type":"A","refField":"TX15"},{"name":"VSER","description":"voucher number series","length":3,"mandatory":false,"type":"A","refField":"VSER"},{"name":"VONO","description":"voucher number","length":8,"mandatory":false,"type":"N","refField":"VONO"},{"name":"VTXT","description":"voucher text","length":40,"mandatory":false,"type":"A","refField":"VTXT"},{"name":"DUDT","description":"due date","length":8,"mandatory":false,"type":"D","refField":"DUDT"},{"name":"CUCD","description":"currency","length":3,"mandatory":false,"type":"A","refField":"CUCD"},{"name":"CUAM","description":"foreign currency amount","length":15,"mandatory":false,"type":"N","refField":"CUAM"},{"name":"TRCD","description":"transaction code","length":2,"mandatory":false,"type":"N","refField":"TRCD"},{"name":"FEID","description":"FAM function","length":4,"mandatory":false,"type":"A","refField":"FEID"},{"name":"FNCN","description":"FAM function","length":3,"mandatory":false,"type":"N","refField":"FNCN"},{"name":"UINO","description":"CINO\\SINO","length":24,"mandatory":false,"type":"A","refField":null},{"name":"CUCK","description":"client check","length":30,"mandatory":false,"type":"A","refField":null},{"name":"SUCK","description":"supplier check","length":30,"mandatory":false,"type":"A","refField":null},{"name":"BNKP","description":"bank page","length":8,"mandatory":false,"type":"A","refField":null},{"name":"PRPN","description":"proposal number","length":30,"mandatory":false,"type":"A","refField":null},{"name":"LCAM","description":"local amount","length":8,"mandatory":false,"type":"A","refField":null},{"name":"JRNO","description":"journal number","length":7,"mandatory":false,"type":"N","refField":"JRNO"},{"name":"JSNO","description":"journal sequence number","length":7,"mandatory":false,"type":"N","refField":"JSNO"},{"name":"YEA4","description":"year","length":4,"mandatory":false,"type":"N","refField":"YEA4"},{"name":"SUNO","description":"supplier","length":10,"mandatory":false,"type":"A","refField":"SUNO"},{"name":"SINO","description":"supplier invoice number","length":24,"mandatory":false,"type":"A","refField":"SINO"},{"name":"IVDT","description":"invoice date","length":8,"mandatory":false,"type":"D","refField":"IVDT"},{"name":"CCHK","description":"Customer check number","length":20,"mandatory":false,"type":"A","refField":null},{"name":"SCCK","description":"Supplier check number","length":20,"mandatory":false,"type":"A","refField":null},{"name":"MASV","description":"MASAV transfer number","length":15,"mandatory":false,"type":"A","refField":null},{"name":"CHKN","description":"Check number","length":10,"mandatory":false,"type":"A","refField":null},{"name":"OPDB","description":"Opening balance – Debit","length":15,"mandatory":false,"type":"N","refField":null},{"name":"OPCR","description":"Opening balance – Credit","length":15,"mandatory":false,"type":"N","refField":null},{"name":"DEBT","description":"DEBIT","length":15,"mandatory":false,"type":"N","refField":null},{"name":"CRED","description":"Credit","length":15,"mandatory":false,"type":"N","refField":null},{"name":"RUNB","description":"Running balance","length":15,"mandatory":false,"type":"N","refField":null},{"name":"ASMA","description":"Asmakhta","length":30,"mandatory":false,"type":"A","refField":null},{"name":"SUNM","description":"supplier name","length":36,"mandatory":false,"type":"A","refField":"SUNM"},{"name":"SIDE","description":"Sup\\Cust","length":10,"mandatory":false,"type":"A","refField":null},{"name":"RTYP","description":"Row type","length":20,"mandatory":false,"type":"A","refField":null},{"name":"CUNM","description":"name","length":36,"mandatory":false,"type":"A","refField":"CUNM"},{"name":"ASM1","description":"Reference","length":10,"mandatory":false,"type":"A","refField":null},{"name":"ASM2","description":"Reference 2","length":10,"mandatory":false,"type":"A","refField":null}],"inputFields":[{"name":"CONO","description":"company","length":3,"mandatory":true,"type":"N","refField":"CONO"},{"name":"DIVI","description":"division","length":3,"mandatory":true,"type":"A","refField":"DIVI"},{"name":"PYNO","description":"payer","length":10,"mandatory":false,"type":"A","refField":"PYNO"},{"name":"FDAT","description":"from date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"TDAT","description":"to date","length":8,"mandatory":false,"type":"A","refField":null},{"name":"CUNO","description":"customer","length":10,"mandatory":false,"type":"A","refField":"CUNO"},{"name":"SUNO","description":"supplier","length":10,"mandatory":false,"type":"A","refField":"SUNO"},{"name":"IVDT","description":"invoice date","length":8,"mandatory":false,"type":"D","refField":"IVDT"},{"name":"SINO","description":"supplier invoice number","length":24,"mandatory":false,"type":"A","refField":"SINO"},{"name":"CUAM","description":"foreign currency amount","length":15,"mandatory":false,"type":"N","refField":"CUAM"},{"name":"SCNO","description":"supplier's customer number","length":10,"mandatory":false,"type":"A","refField":"SCNO"}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"a070e177-813e-4d2e-8572-e7e0d6da7939":{"uuid":"a070e177-813e-4d2e-8572-e7e0d6da7939","updated":1763892419615,"updatedBy":"YAEL","created":1763901476110,"createdBy":"ERP2024","apiVersion":"0.21","beVersion":"16.0.0.20250917153352.6","language":"GROOVY","codeHash":"1E8B6B856D38383FB3358555A0C8F33E355571CB62EB3BB2632C10935AEC6DD4","code":"aW1wb3J0IGphdmEudXRpbC4qDQoNCnB1YmxpYyBjbGFzcyBsc3RDdXN0U3VwcGxpZXIgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaQ0KICBwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlDQogIHByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtDQogIHByaXZhdGUgZmluYWwgTG9nZ2VyQVBJIGxvZ2dlcg0KDQogIC8vIC0tLS0tLS0tLS0tLS0tLS0gQ29sdW1ucyAoYXMgY29uc3RhbnRzKSAtLS0tLS0tLS0tLS0tLS0tDQogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIEZQTEVER19GSUVMRFMgPSBbDQogICAgIkVQQ09OTyIsIkVQRElWSSIsIkVQWUVBNCIsIkVQSlJOTyIsIkVQSlNOTyIsIkVQQUNEVCIsDQogICAgIkVQU1VOTyIsIkVQU0lOTyIsIkVQSVZEVCIsIkVQVlNFUiIsIkVQVk9OTyIsIkVQRFVEVCIsIkVQQ1VDRCIsDQogICAgIkVQQ1VBTSIsIkVQVFJDRCIsIkVQSVZUUCINCiAgXQ0KICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBGR0xFREdfRklFTERTID0gWw0KICAgICJFR0NPTk8iLCJFR0RJVkkiLCJFR1lFQTQiLCJFR0pSTk8iLCJFR0pTTk8iLCJFR0ZFSUQiLCJFR0ZOQ04iLCJFR1ZUWFQiLCJFR0FDQU0iDQogIF0NCiAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nW10gRkFQQ0hLX0ZJRUxEU19TQUZFID0gIFsNCiAgICAiQ0tDT05PIiwiQ0tESVZJIiwiQ0tWU0VSIiwiQ0tWT05PIiwiQ0tDSEtOIg0KICBdDQogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIENTWU5CVl9GSUVMRFMgPSBbDQogICAgIkRWQ09OTyIsIkRWRElWSSIsIkRWVlNFUiIsIkRWVFgxNSINCiAgXQ0KICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBGUExFRFhfRklFTERTID0gWw0KICAgICJFUENPTk8iLCJFUERJVkkiLCJFUFlFQTQiLCJFUEpSTk8iLCJFUEpTTk8iLCJFUFBFWE4iLCJFUFBFWEkiDQogIF0NCiAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nW10gRlNMRURHX0ZJRUxEUyA9IFsNCiAgICAiRVNDT05PIiwiRVNESVZJIiwiRVNZRUE0IiwiRVNKUk5PIiwiRVNKU05PIiwiRVNBQ0RUIiwNCiAgICAiRVNQWU5PIiwiRVNDSU5PIiwiRVNJVkRUIiwiRVNWU0VSIiwiRVNWT05PIiwiRVNEVURUIiwiRVNDVUNEIiwNCiAgICAiRVNDVUFNIiwiRVNJVlRQIiwiRVNUUkNEIiwiRVNQWVJTIg0KICBdDQogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIEZTTEVEWF9GSUVMRFMgPSBbDQogICAgIlNFQ09OTyIsIlNFRElWSSIsIlNFWUVBNCIsIlNFSlJOTyIsIlNFSlNOTyIsIlNFWE4iLCJTRVhJIg0KICBdDQogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIE9DVVNNQV9GSUVMRFMgPSBbDQogICAgIk9LQ09OTyIsIk9LQ1VOTyIsIk9LQ1VOTSINCiAgXQ0KICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBGRFJGTUFfRklFTERTID0gWw0KICAgICJETURSUk4iDQogIF0NCiAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nW10gQ0lETUFTX0ZJRUxEUyA9IFsNCiAgICAiSURDT05PIiwiSURTVU5PIiwiSURTVU5NIg0KICBdDQoNCiAgLy8gLS0tLS0tLS0tLS0tLS0tLSBJbnB1dHMgLS0tLS0tLS0tLS0tLS0tLQ0KICBwcml2YXRlIGludCAgICBDT05PDQogIHByaXZhdGUgU3RyaW5nIERJVkksIFNVTk8sIFNDTk8sIENVTk8sIFBZTk8NCiAgcHJpdmF0ZSBpbnQgICAgRkRBVCwgVERBVA0KDQogIC8vIHJ1bm5pbmcgYmFsYW5jZSBhY2N1bXVsYXRvcnMNCiAgcHJpdmF0ZSBkb3VibGUgb3BlbmluZyA9IDBkDQogIHByaXZhdGUgZG91YmxlIHJ1bm5pbmcgPSAwZA0KICANCiAgcHJpdmF0ZSBMaXN0PE1hcDxTdHJpbmcsU3RyaW5nPj4gYWxsUm93cyA9IFtdDQoNCiAgcHVibGljIGxzdEN1c3RTdXBwbGllcihNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIFByb2dyYW1BUEkgcHJvZ3JhbSwgTG9nZ2VyQVBJIGxvZ2dlcikgew0KICAgIHRoaXMubWkgPSBtaQ0KICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZQ0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW0NCiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcg0KICB9DQoNCiAgcHVibGljIHZvaWQgbWFpbigpIHsNCiAgICAvLyBQYXJzZSBpbnB1dHMNCiAgICBDT05PID0gc2FmZUludDIobWkuaW5EYXRhLmdldCgiQ09OTyIpLCBwcm9ncmFtLmdldExEQVpEKCkuQ09OTykNCiAgICBESVZJID0gcyhtaS5pbkRhdGEuZ2V0KCJESVZJIikpDQogICAgU1VOTyA9IHMobWkuaW5EYXRhLmdldCgiU1VOTyIpKQ0KICAgIFBZTk8gPSBzKG1pLmluRGF0YS5nZXQoIlBZTk8iKSkNCiAgICBTQ05PID0gcyhtaS5pbkRhdGEuZ2V0KCJTQ05PIikpDQogICAgQ1VOTyA9IHMobWkuaW5EYXRhLmdldCgiQ1VOTyIpKQ0KICAgIEZEQVQgPSB0b0ludChtaS5pbkRhdGEuZ2V0KCJGREFUIikpDQogICAgVERBVCA9IHRvSW50KG1pLmluRGF0YS5nZXQoIlREQVQiKSkNCg0KICAgIGlmIChpc0VtcHR5KERJVkkpKSB7IG1pLmVycm9yKCJESVZJIGlzIHJlcXVpcmVkIik7IHJldHVybiB9DQogICAgaWYgKENPTk8gPD0gMCkgICAgIHsgbWkuZXJyb3IoIkNPTk8gaXMgcmVxdWlyZWQiKTsgcmV0dXJuIH0NCiAgICBpZiAoVERBVCAhPSAwICYmIEZEQVQgIT0gMCAmJiBUREFUIDwgRkRBVCkgeyBtaS5lcnJvcigiVERBVCBtdXN0IGJlID49IEZEQVQiKTsgcmV0dXJuIH0NCg0KICAgIC8vIE9wZW5pbmcgYmFsYW5jZSAo0LTQviBGREFUKSA9IEFQICsgQVIgKNCyINCy0LDQu9GO0YLQtSDQtNCy0LjQttC10L3QuNGPLCDRgi7QtS4gQ1VBTSkNCiAgICBvcGVuaW5nID0gc3VtT3BlbmluZ0FQKENPTk8sIERJVkksIFNVTk8sIEZEQVQpICsgc3VtT3BlbmluZ0FSKENPTk8sIERJVkksIGZpcnN0TlozKFNDTk8sIENVTk8sIFBZTk8pLCBGREFUKQ0KICAgIHJ1bm5pbmcgPSBvcGVuaW5nDQoNCiAgICAvLyBBUCBicmFuY2ggKHN1cHBsaWVyKTog0LzQvtC20L3QviDQvdC1INCy0YvQt9GL0LLQsNGC0YwsINC10YHQu9C4INC90LUg0LLRi9Cx0YDQsNC9IFNVTk8NCiAgICBpZiAoIWlzRW1wdHkoU1VOTykpIHsNCiAgICAgIHJlYWRGUExFREcoKQ0KICAgIH0NCg0KICAgIC8vIEFSIGJyYW5jaCAobGlua2VkIGN1c3RvbWVyKS4g0J/QviDQotCXINGB0L7QvtCx0YnQsNC10Lwg0L7QsSDQvtGC0YHRg9GC0YHRgtCy0LjQuCDRgdCy0Y/Qt9Cw0L3QvdC+0LPQviDQutC70LjQtdC90YLQsC4NCiAgICBTdHJpbmcgbGlua2VkID0gZmlyc3ROWjMoU0NOTywgQ1VOTywgUFlOTykNCiAgICBpZiAoaXNFbXB0eShsaW5rZWQpKSB7DQogICAgICBtaS5lcnJvcigiTm8gbGlua2VkIGN1c3RvbWVyIChTQ05PL0NVTk8vUFlOTyBpcyBlbXB0eSkgZm9yIHRoZSBzZWxlY3RlZCBzdXBwbGllciIpDQogICAgICByZXR1cm4NCiAgICB9DQogICAgcmVhZEZTTEVERyhsaW5rZWQpDQogICAgc2VuZFRvT3V0cHV0KCk7DQogIH0NCg0KICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAvLyBPcGVuaW5nIHN1bXMNCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgcHJpdmF0ZSBkb3VibGUgc3VtT3BlbmluZ0FQKGludCBjb25vLCBTdHJpbmcgZGl2aSwgU3RyaW5nIHN1bm8sIGludCBiZWZvcmVBY2R0KSB7DQogICAgaWYgKGlzRW1wdHkoc3VubykgfHwgYmVmb3JlQWNkdCA9PSAwKSByZXR1cm4gMGQNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBlZiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJGUExFREciKQ0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cCA9IGVmLmVxKCJFUENPTk8iLCBTdHJpbmcudmFsdWVPZihjb25vKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVQRElWSSIsIGRpdmkpKQ0KICAgICAgLmFuZChlZi5lcSgiRVBTVU5PIiwgc3VubykpDQogICAgICAuYW5kKGVmLmx0KCJFUEFDRFQiLCBTdHJpbmcudmFsdWVPZihiZWZvcmVBY2R0KSkpDQogICAgICAvLyDRgtC1INC20LUg0LHQuNC30L3QtdGBLdC+0LPRgNCw0L3QuNGH0LXQvdC40Y8sINGH0YLQviDQuCDQsiDQvtGB0L3QvtCy0L3QvtC5INCy0YvQsdC+0YDQutC1DQogICAgICAuYW5kKCBlZi5lcSgiRVBJVlRQIiwiQVAiKS5vciggZWYuZXEoIkVQVFJDRCIsIjQwIikub3IoIGVmLmVxKCJFUFRSQ0QiLCI1MCIpICkgKSApDQoNCiAgICBEQkFjdGlvbiBhID0gZGF0YWJhc2UudGFibGUoIkZQTEVERyIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oIkVQQ1VBTSIpDQogICAgICAuYnVpbGQoKQ0KDQogICAgREJDb250YWluZXIgYyA9IGEuZ2V0Q29udGFpbmVyKCkNCiAgICBmaW5hbCBkb3VibGVbXSBzdW0gPSBuZXcgZG91YmxlWzFdDQogICAgYS5yZWFkQWxsKGMsIDAsIDEwMDAwMCwgeyBEQkNvbnRhaW5lciByb3cgLT4NCiAgICAgIHN1bVswXSArPSB0b0RvdWJsZShyb3cuZ2V0KCJFUENVQU0iKSkNCiAgICB9KQ0KICAgIHJldHVybiBzdW1bMF0NCiAgfQ0KDQogIHByaXZhdGUgZG91YmxlIHN1bU9wZW5pbmdBUihpbnQgY29ubywgU3RyaW5nIGRpdmksIFN0cmluZyBwYXllciwgaW50IGJlZm9yZUFjZHQpIHsNCiAgICBpZiAoaXNFbXB0eShwYXllcikgfHwgYmVmb3JlQWNkdCA9PSAwKSByZXR1cm4gMGQNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBlZiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJGU0xFREciKQ0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cCA9IGVmLmVxKCJFU0NPTk8iLCBTdHJpbmcudmFsdWVPZihjb25vKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVTRElWSSIsIGRpdmkpKQ0KICAgICAgLmFuZChlZi5lcSgiRVNQWU5PIiwgcGF5ZXIpKQ0KICAgICAgLmFuZChlZi5sdCgiRVNBQ0RUIiwgU3RyaW5nLnZhbHVlT2YoYmVmb3JlQWNkdCkpKQ0KICAgICAgLy8g0LzRj9Cz0LrQuNC5INGE0LjQu9GM0YLRgCDQv9C+INCi0JcNCiAgICAgIC5hbmQoIGVmLmVxKCJFU1BZUlMiLCIiKS5vciggZWYubHQoIkVTUFlSUyIsIjcwIikgKSApDQoNCiAgICBEQkFjdGlvbiBhID0gZGF0YWJhc2UudGFibGUoIkZTTEVERyIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oIkVTQ1VBTSIpDQogICAgICAuYnVpbGQoKQ0KDQogICAgREJDb250YWluZXIgYyA9IGEuZ2V0Q29udGFpbmVyKCkNCiAgICBmaW5hbCBkb3VibGVbXSBzdW0gPSBuZXcgZG91YmxlWzFdDQogICAgYS5yZWFkQWxsKGMsIDAsIDEwMDAwMCwgeyBEQkNvbnRhaW5lciByb3cgLT4NCiAgICAgIHN1bVswXSArPSB0b0RvdWJsZShyb3cuZ2V0KCJFU0NVQU0iKSkNCiAgICB9KQ0KICAgIHJldHVybiBzdW1bMF0NCiAgfQ0KDQogIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogIC8vIEFQOiBGUExFREcgKyBGR0xFREcgKCsgRkFQQ0hLIC8gQ1NZTkJWIC8gRlBMRURYIC8gQ0lETUFTKQ0KICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICB2b2lkIHJlYWRGUExFREcoKSB7DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiRlBMRURHIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiRVBDT05PIiwgU3RyaW5nLnZhbHVlT2YoQ09OTykpDQogICAgICAuYW5kKGVmLmVxKCJFUERJVkkiLCBESVZJKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVQU1VOTyIsIFNVTk8pKQ0KDQogICAgaWYgKEZEQVQgIT0gMCkgZXhwID0gZXhwLmFuZChlZi5nZSgiRVBBQ0RUIiwgU3RyaW5nLnZhbHVlT2YoRkRBVCkpKQ0KICAgIGlmIChUREFUICE9IDApIGV4cCA9IGV4cC5hbmQoZWYubGUoIkVQQUNEVCIsIFN0cmluZy52YWx1ZU9mKFREQVQpKSkNCg0KICAgIC8vIChFUElWVFA9J0FQJykgT1IgKEVQVFJDRCBpbiA0MCw1MCkNCiAgICBleHAgPSBleHAuYW5kKCBlZi5lcSgiRVBJVlRQIiwiQVAiKS5vciggZWYuZXEoIkVQVFJDRCIsIjQwIikub3IoIGVmLmVxKCJFUFRSQ0QiLCI1MCIpICkgKSApDQoNCiAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRlBMRURHIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihGUExFREdfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYWN0aW9uLmdldENvbnRhaW5lcigpDQoNCiAgICBhY3Rpb24ucmVhZEFsbChjLCAwLCAxMDAwMDAsIHsgREJDb250YWluZXIgZnAgLT4NCiAgICAgIE1hcDxTdHJpbmcsU3RyaW5nPiByID0gbmV3IEhhc2hNYXA8U3RyaW5nLFN0cmluZz4oKQ0KICAgICAgZm9yIChTdHJpbmcgZiA6IEZQTEVER19GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBmcC5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQoNCiAgICAgIGpvaW5GR0xFREdfZnJvbUZQKHIpDQogICAgICBqb2luRkFQQ0hLKHIpDQogICAgICBqb2luQ1NZTkJWX2Zyb21WU0VSX0FQKHIpDQogICAgICBqb2luRlBMRURYKHIsICI0MDkiKQ0KICAgICAgam9pbkZQTEVEWChyLCAiNDA0IikvL1lhZWwuIDE3LjExLjIwMjUNCiAgICAgIGpvaW5GUExFRFgociwgIjQwNiIpLy9ZYWVsLiAxOS4xMS4yMDI1DQogICAgICBqb2luQ0lETUFTKHIsIHIuZ2V0KCJFUFNVTk8iKSkgIC8vINC40LzRjyDQv9C+0YHRgtCw0LLRidC40LrQsA0KICAgICAgc2V0U3VwcGxpZXJBc21hY2h0YVZhbHVlKHIpLy9ZYWVsLiAyMC8xMS8yMDI1DQoNCiAgICAgIHdyaXRlUm93KHIsIGZhbHNlKSAvLyBBUA0KICAgIH0pDQogIH0NCg0KICAvLyBGR0xFREcgam9pbiBmb3IgQVANCiAgdm9pZCBqb2luRkdMRURHX2Zyb21GUChNYXA8U3RyaW5nLFN0cmluZz4gcikgew0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGVmID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkZHTEVERyIpDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwID0gZWYuZXEoIkVHQ09OTyIsIHIuZ2V0KCJFUENPTk8iKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVHRElWSSIsIHIuZ2V0KCJFUERJVkkiKSkpDQogICAgICAuYW5kKGVmLmVxKCJFR1lFQTQiLCByLmdldCgiRVBZRUE0IikpKQ0KICAgICAgLmFuZChlZi5lcSgiRUdKUk5PIiwgci5nZXQoIkVQSlJOTyIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVHSlNOTyIsIHIuZ2V0KCJFUEpTTk8iKSkpDQogICAgICAvLyDQv9C+INC30LDQvNC10YLQutC1OiBFR0ZFSUQ9J0FQMTAnIE9SIEVHRk5DTiE9JzUwMCcNCiAgICAgIC5hbmQoIGVmLmVxKCJFR0ZFSUQiLCJBUDEwIikub3IoIGVmLm5lKCJFR0ZOQ04iLCI1MDAiKSApICkNCg0KICAgIERCQWN0aW9uIGEgPSBkYXRhYmFzZS50YWJsZSgiRkdMRURHIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihGR0xFREdfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYS5nZXRDb250YWluZXIoKQ0KDQogICAgYS5yZWFkQWxsKGMsIDAsIDUsIHsgREJDb250YWluZXIgZmcgLT4NCiAgICAgIGZvciAoU3RyaW5nIGYgOiBGR0xFREdfRklFTERTKSB7DQogICAgICAgIE9iamVjdCB2ID0gZmcuZ2V0KGYpDQogICAgICAgIHIucHV0KGYsIHYgPT0gbnVsbCA/ICIiIDogdi50b1N0cmluZygpKQ0KICAgICAgfQ0KICAgIH0pDQogIH0NCg0KICAvLyBGQVBDSEsgKExGIDAwKSBmb3IgQVANCiAgdm9pZCBqb2luRkFQQ0hLKE1hcDxTdHJpbmcsU3RyaW5nPiByKSB7DQogICAgU3RyaW5nIHZzZXIgPSByLmdldCgiRVBWU0VSIikNCiAgICBTdHJpbmcgdm9ubyA9IHIuZ2V0KCJFUFZPTk8iKQ0KICAgIGlmIChpc0VtcHR5KHZzZXIpIHx8IGlzRW1wdHkodm9ubykpIHJldHVybg0KDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiRkFQQ0hLIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiQ0tDT05PIiwgci5nZXQoIkVQQ09OTyIpKQ0KICAgICAgLmFuZChlZi5lcSgiQ0tESVZJIiwgci5nZXQoIkVQRElWSSIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkNLVlNFUiIsIHZzZXIpKQ0KICAgICAgLmFuZChlZi5lcSgiQ0tWT05PIiwgdm9ubykpDQoNCiAgICBEQkFjdGlvbiBhID0gZGF0YWJhc2UudGFibGUoIkZBUENISyIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oRkFQQ0hLX0ZJRUxEU19TQUZFKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYS5nZXRDb250YWluZXIoKQ0KDQogICAgYS5yZWFkQWxsKGMsIDAsIDEsIHsgREJDb250YWluZXIgY2sgLT4NCiAgICAgIGZvciAoU3RyaW5nIGYgOiBGQVBDSEtfRklFTERTX1NBRkUpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBjay5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQogICAgfSkNCiAgfQ0KDQogIC8vIENTWU5CViBzaG9ydCB0ZXh0IGZvciBBUCBieSBWU0VSDQogIHZvaWQgam9pbkNTWU5CVl9mcm9tVlNFUl9BUChNYXA8U3RyaW5nLFN0cmluZz4gcikgew0KICAgIFN0cmluZyB2c2VyID0gci5nZXQoIkVQVlNFUiIpDQogICAgaWYgKGlzRW1wdHkodnNlcikpIHJldHVybg0KDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiQ1NZTkJWIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiRFZDT05PIiwgci5nZXQoIkVQQ09OTyIpKQ0KICAgICAgLmFuZChlZi5lcSgiRFZESVZJIiwgci5nZXQoIkVQRElWSSIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkRWVlNFUiIsIHZzZXIpKQ0KDQogICAgREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkNTWU5CViIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oQ1NZTkJWX0ZJRUxEUykNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgYyA9IGFjdGlvbi5nZXRDb250YWluZXIoKQ0KDQogICAgYWN0aW9uLnJlYWRBbGwoYywgMCwgMSwgeyBEQkNvbnRhaW5lciBjcyAtPg0KICAgICAgZm9yIChTdHJpbmcgZiA6IENTWU5CVl9GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBjcy5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQogICAgfSkNCiAgfQ0KDQogIC8vIEZQTEVEWCAoRVBQRVhOPTQwOSAtPiBNQVNBVi9QUk9QIG51bWJlcikNCiAgdm9pZCBqb2luRlBMRURYKE1hcDxTdHJpbmcsU3RyaW5nPiByLCBTdHJpbmcgcGV4bikgew0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGVmID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkZQTEVEWCIpDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwID0gZWYuZXEoIkVQQ09OTyIsIHIuZ2V0KCJFUENPTk8iKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVQRElWSSIsIHIuZ2V0KCJFUERJVkkiKSkpDQogICAgICAuYW5kKGVmLmVxKCJFUFlFQTQiLCByLmdldCgiRVBZRUE0IikpKQ0KICAgICAgLmFuZChlZi5lcSgiRVBKUk5PIiwgci5nZXQoIkVQSlJOTyIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVQSlNOTyIsIHIuZ2V0KCJFUEpTTk8iKSkpDQogICAgICAuYW5kKGVmLmVxKCJFUFBFWE4iLCBwZXhuKSkNCg0KICAgIERCQWN0aW9uIGEgPSBkYXRhYmFzZS50YWJsZSgiRlBMRURYIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihGUExFRFhfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYS5nZXRDb250YWluZXIoKQ0KDQogICAgYS5yZWFkQWxsKGMsIDAsIDMsIHsgREJDb250YWluZXIgZHggLT4NCiAgICAgIGZvciAoU3RyaW5nIGYgOiBGUExFRFhfRklFTERTKSB7DQogICAgICAgIE9iamVjdCB2ID0gZHguZ2V0KGYpDQogICAgICAgIGlmKHBleG4gPT0gIjQwOSIpey8vWWFlbC4gMTcvMTEvMjAyNQ0KICAgICAgICAgIHIucHV0KGYsIHYgPT0gbnVsbCA/ICIiIDogdi50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgfWVsc2UgaWYocGV4biA9PSAiNDA0Iil7Ly9ZYWVsLiAxNy8xMS8yMDI1DQogICAgICAgICAgIHIucHV0KGYgKyAiNDA0IiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkudHJpbSgpKS8vWWFlbC4gMTcvMTEvMjAyNQ0KICAgICAgICB9ZWxzZSBpZihwZXhuID09ICI0MDYiKXsvL1lhZWwuIDE3LzExLzIwMjUNCiAgICAgICAgICAgci5wdXQoZiArICI0MDYiLCB2ID09IG51bGwgPyAiIiA6IHYudG9TdHJpbmcoKS50cmltKCkpLy9ZYWVsLiAxNy8xMS8yMDI1DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9KQ0KICB9DQoNCiAgLy8gQ0lETUFTIGpvaW4gZm9yIHN1cHBsaWVyIG5hbWUNCiAgdm9pZCBqb2luQ0lETUFTKE1hcDxTdHJpbmcsU3RyaW5nPiByLCBTdHJpbmcgc3VwcGxpZXJOdW1iZXIpIHsNCiAgICBpZiAoaXNFbXB0eShzdXBwbGllck51bWJlcikpIHJldHVybg0KICAgIA0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGVmID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkNJRE1BUyIpDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwID0gZWYuZXEoIklEQ09OTyIsIFN0cmluZy52YWx1ZU9mKENPTk8pKQ0KICAgICAgLmFuZChlZi5lcSgiSURTVU5PIiwgc3VwcGxpZXJOdW1iZXIpKQ0KICAgIA0KICAgIERCQWN0aW9uIGEgPSBkYXRhYmFzZS50YWJsZSgiQ0lETUFTIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihDSURNQVNfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYS5nZXRDb250YWluZXIoKQ0KICAgIA0KICAgIGEucmVhZEFsbChjLCAwLCAxLCB7IERCQ29udGFpbmVyIGNkIC0+DQogICAgICBmb3IgKFN0cmluZyBmIDogQ0lETUFTX0ZJRUxEUykgew0KICAgICAgICBPYmplY3QgdiA9IGNkLmdldChmKQ0KICAgICAgICByLnB1dChmLCB2ID09IG51bGwgPyAiIiA6IHYudG9TdHJpbmcoKSkNCiAgICAgIH0NCiAgICB9KQ0KICB9DQoNCiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAgLy8gQVI6IEZTTEVERyArIEZHTEVERyAoKyBDU1lOQlYgKyBGU0xFRFhbMjEyLDIxMywyMTQsMjE1XSArIE9DVVNNQSkNCiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAgdm9pZCByZWFkRlNMRURHKFN0cmluZyBsaW5rZWRDdXN0b21lcikgew0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGVmID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkZTTEVERyIpDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwID0gZWYuZXEoIkVTQ09OTyIsIFN0cmluZy52YWx1ZU9mKENPTk8pKQ0KICAgICAgLmFuZChlZi5lcSgiRVNESVZJIiwgRElWSSkpDQogICAgICAuYW5kKGVmLmVxKCJFU1BZTk8iLCBsaW5rZWRDdXN0b21lcikpDQoNCiAgICBpZiAoRkRBVCAhPSAwKSBleHAgPSBleHAuYW5kKGVmLmdlKCJFU0FDRFQiLCBTdHJpbmcudmFsdWVPZihGREFUKSkpDQogICAgaWYgKFREQVQgIT0gMCkgZXhwID0gZXhwLmFuZChlZi5sZSgiRVNBQ0RUIiwgU3RyaW5nLnZhbHVlT2YoVERBVCkpKQ0KDQogICAgLy8g0LzRj9Cz0LrQuNC5INGE0LjQu9GM0YLRgA0KICAgIGV4cCA9IGV4cC5hbmQoIGVmLmVxKCJFU1BZUlMiLCIiKS5vciggZWYubHQoIkVTUFlSUyIsIjcwIikgKSApDQoNCiAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRlNMRURHIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihGU0xFREdfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYWN0aW9uLmdldENvbnRhaW5lcigpDQoNCiAgICBhY3Rpb24ucmVhZEFsbChjLCAwLCAxMDAwMDAsIHsgREJDb250YWluZXIgZnMgLT4NCiAgICAgIE1hcDxTdHJpbmcsU3RyaW5nPiByID0gbmV3IEhhc2hNYXA8U3RyaW5nLFN0cmluZz4oKQ0KICAgICAgZm9yIChTdHJpbmcgZiA6IEZTTEVER19GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBmcy5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQoNCiAgICAgIGpvaW5GR0xFREdfZnJvbUZTKHIpDQogICAgICBqb2luQ1NZTkJWX2Zyb21WU0VSX0FSKHIpDQogICAgICBqb2luT0NVU01BKHIsIHIuZ2V0KCJFU1BZTk8iKSkgIC8vINC40LzRjyDQutC70LjQtdC90YLQsA0KICAgICAgam9pbkZEUkZNQShyLCByLmdldCgiRVNDSU5PIikpLy9ZYWVsLiAyMC8xMS8yMDI1DQogICAgICBzZXRDdXN0b21lckFzbWFjaHRhVmFsdWUocikvL1lhZWwuIDIwLzExLzIwMjUNCiAgICAgIC8vIGpvaW5GU0xFRFhfb25lKHIsICIyMTMiLCAiQ1VTVF9DSyIpDQogICAgICAvLyBqb2luRlNMRURYX29uZShyLCAiMjE0IiwgIkNfU19DSyIpDQogICAgICAvLyBqb2luRlNMRURYX29uZShyLCAiMjE1IiwgIkJBTktfUEFHRSIpDQogICAgICAvLyBqb2luRlNMRURYX29uZShyLCAiMjEyIiwgIlBST1BfTiIpDQoNCiAgICAgIHdyaXRlUm93KHIsIHRydWUpIC8vIEFSDQogICAgfSkNCiAgfQ0KDQogIC8vIEZHTEVERyBqb2luIGZvciBBUg0KICB2b2lkIGpvaW5GR0xFREdfZnJvbUZTKE1hcDxTdHJpbmcsU3RyaW5nPiByKSB7DQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiRkdMRURHIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiRUdDT05PIiwgci5nZXQoIkVTQ09OTyIpKQ0KICAgICAgLmFuZChlZi5lcSgiRUdESVZJIiwgci5nZXQoIkVTRElWSSIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkVHWUVBNCIsIHIuZ2V0KCJFU1lFQTQiKSkpDQogICAgICAuYW5kKGVmLmVxKCJFR0pSTk8iLCByLmdldCgiRVNKUk5PIikpKQ0KICAgICAgLmFuZChlZi5lcSgiRUdKU05PIiwgci5nZXQoIkVTSlNOTyIpKSkNCg0KICAgIERCQWN0aW9uIGEgPSBkYXRhYmFzZS50YWJsZSgiRkdMRURHIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwKQ0KICAgICAgLnNlbGVjdGlvbihGR0xFREdfRklFTERTKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjID0gYS5nZXRDb250YWluZXIoKQ0KDQogICAgYS5yZWFkQWxsKGMsIDAsIDUsIHsgREJDb250YWluZXIgZmcgLT4NCiAgICAgIGZvciAoU3RyaW5nIGYgOiBGR0xFREdfRklFTERTKSB7DQogICAgICAgIE9iamVjdCB2ID0gZmcuZ2V0KGYpDQogICAgICAgIHIucHV0KGYsIHYgPT0gbnVsbCA/ICIiIDogdi50b1N0cmluZygpKQ0KICAgICAgfQ0KICAgIH0pDQogIH0NCg0KICAvLyBDU1lOQlYgZm9yIEFSIGJ5IEVTVlNFUg0KICB2b2lkIGpvaW5DU1lOQlZfZnJvbVZTRVJfQVIoTWFwPFN0cmluZyxTdHJpbmc+IHIpIHsNCiAgICBTdHJpbmcgdnNlciA9IHIuZ2V0KCJFU1ZTRVIiKQ0KICAgIGlmIChpc0VtcHR5KHZzZXIpKSByZXR1cm4NCg0KICAgIFN0cmluZyBkdmNvbm8gPSBpc0VtcHR5KHIuZ2V0KCJFU0NPTk8iKSkgPyBTdHJpbmcudmFsdWVPZihDT05PKSA6IHIuZ2V0KCJFU0NPTk8iKQ0KDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiQ1NZTkJWIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiRFZDT05PIiwgZHZjb25vKQ0KICAgICAgLmFuZChlZi5lcSgiRFZESVZJIiwgci5nZXQoIkVTRElWSSIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIkRWVlNFUiIsIHZzZXIpKQ0KDQogICAgREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkNTWU5CViIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oQ1NZTkJWX0ZJRUxEUykNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgYyA9IGFjdGlvbi5nZXRDb250YWluZXIoKQ0KDQogICAgYWN0aW9uLnJlYWRBbGwoYywgMCwgMSwgeyBEQkNvbnRhaW5lciBjcyAtPg0KICAgICAgZm9yIChTdHJpbmcgZiA6IENTWU5CVl9GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBjcy5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQogICAgfSkNCiAgfQ0KDQogIC8vIE9DVVNNQSBqb2luIGZvciBjdXN0b21lciBuYW1lDQogIHZvaWQgam9pbk9DVVNNQShNYXA8U3RyaW5nLFN0cmluZz4gciwgU3RyaW5nIGN1c3RvbWVyTnVtYmVyKSB7DQogICAgaWYgKGlzRW1wdHkoY3VzdG9tZXJOdW1iZXIpKSByZXR1cm4NCiAgICANCiAgICBFeHByZXNzaW9uRmFjdG9yeSBlZiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJPQ1VTTUEiKQ0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cCA9IGVmLmVxKCJPS0NPTk8iLCBTdHJpbmcudmFsdWVPZihDT05PKSkNCiAgICAgIC5hbmQoZWYuZXEoIk9LQ1VOTyIsIGN1c3RvbWVyTnVtYmVyKSkNCiAgICANCiAgICBEQkFjdGlvbiBhID0gZGF0YWJhc2UudGFibGUoIk9DVVNNQSIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oT0NVU01BX0ZJRUxEUykNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgYyA9IGEuZ2V0Q29udGFpbmVyKCkNCiAgICANCiAgICBhLnJlYWRBbGwoYywgMCwgMSwgeyBEQkNvbnRhaW5lciBvYyAtPg0KICAgICAgZm9yIChTdHJpbmcgZiA6IE9DVVNNQV9GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBvYy5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQogICAgfSkNCiAgfQ0KICANCiAgIC8vIEZEUkZNQSBqb2luIGZvciBkcnJuDQogIHZvaWQgam9pbkZEUkZNQShNYXA8U3RyaW5nLFN0cmluZz4gciwgU3RyaW5nIGNpbm8pIHsNCiAgICBpZiAoaXNFbXB0eShjaW5vKSkgcmV0dXJuDQogICAgDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZWYgPSBkYXRhYmFzZS5nZXRFeHByZXNzaW9uRmFjdG9yeSgiRkRSRk1BIikNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBleHAgPSBlZi5lcSgiRE1DT05PIiwgU3RyaW5nLnZhbHVlT2YoQ09OTykpDQogICAgICAuYW5kKGVmLmVxKCJETURJVkkiLCBESVZJKSkuYW5kKGVmLmVxKCJETUNJTk8iLCBjaW5vKSkNCiAgICANCiAgICBEQkFjdGlvbiBhID0gZGF0YWJhc2UudGFibGUoIkZEUkZNQSIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC5zZWxlY3Rpb24oRkRSRk1BX0ZJRUxEUykNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgYyA9IGEuZ2V0Q29udGFpbmVyKCkNCiAgICANCiAgICBhLnJlYWRBbGwoYywgMCwgMSwgeyBEQkNvbnRhaW5lciBvYyAtPg0KICAgICAgZm9yIChTdHJpbmcgZiA6IEZEUkZNQV9GSUVMRFMpIHsNCiAgICAgICAgT2JqZWN0IHYgPSBvYy5nZXQoZikNCiAgICAgICAgci5wdXQoZiwgdiA9PSBudWxsID8gIiIgOiB2LnRvU3RyaW5nKCkpDQogICAgICB9DQogICAgfSkNCiAgfQ0KDQogIC8vIEZTTEVEWCByZWFkZXIgZm9yIG9uZSBTRVhOIC0+IHdyaXRlIGludG8gb3V0S2V5DQogIHZvaWQgam9pbkZTTEVEWF9vbmUoTWFwPFN0cmluZyxTdHJpbmc+IHIsIFN0cmluZyBzZXhuLCBTdHJpbmcgb3V0S2V5KSB7DQogICAgU3RyaW5nIHNlY29ubyA9IGlzRW1wdHkoci5nZXQoIkVTQ09OTyIpKSA/IFN0cmluZy52YWx1ZU9mKENPTk8pIDogci5nZXQoIkVTQ09OTyIpDQoNCiAgICBFeHByZXNzaW9uRmFjdG9yeSBlZiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJGU0xFRFgiKQ0KICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cCA9IGVmLmVxKCJTRUNPTk8iLCBzZWNvbm8pDQogICAgICAuYW5kKGVmLmVxKCJTRURJVkkiLCByLmdldCgiRVNESVZJIikpKQ0KICAgICAgLmFuZChlZi5lcSgiU0VZRUE0Iiwgci5nZXQoIkVTWUVBNCIpKSkNCiAgICAgIC5hbmQoZWYuZXEoIlNFSlJOTyIsIHIuZ2V0KCJFU0pSTk8iKSkpDQogICAgICAuYW5kKGVmLmVxKCJTRUpTTk8iLCByLmdldCgiRVNKU05PIikpKQ0KICAgICAgLmFuZChlZi5lcSgiU0VYTiIsIHNleG4pKQ0KDQogICAgREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkZTTEVEWCIpLmluZGV4KCIwMCIpLm1hdGNoaW5nKGV4cCkNCiAgICAgIC8vINCS0JDQltCd0J46INCy0YvQsdC40YDQsNC10Lwg0YLQvtC70YzQutC+INC30L3QsNGH0LXQvdC40LUsINC90LjQutCw0LrQuNGFINC60LvRjtGH0LXQuQ0KICAgICAgLnNlbGVjdGlvbigiU0VYSSIpDQogICAgICAuYnVpbGQoKQ0KICAgIERCQ29udGFpbmVyIGMgPSBhY3Rpb24uZ2V0Q29udGFpbmVyKCkNCg0KICAgIGFjdGlvbi5yZWFkQWxsKGMsIDAsIDEsIHsgREJDb250YWluZXIgZHggLT4NCiAgICAgIE9iamVjdCB2ID0gZHguZ2V0KCJTRVhJIikNCiAgICAgIFN0cmluZyBzVmFsID0gKHYgPT0gbnVsbCkgPyAiIiA6IHYudG9TdHJpbmcoKQ0KICAgICAgaWYgKCFpc0VtcHR5KHNWYWwpKSByLnB1dChvdXRLZXksIHNWYWwpDQogICAgfSkNCiAgfQ0KDQogIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogIC8vIFVuaWZpZWQgb3V0cHV0ICsgcnVubmluZyBiYWxhbmNlDQogIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogdm9pZCB3cml0ZVJvdyhNYXA8U3RyaW5nLFN0cmluZz4gciwgYm9vbGVhbiBpc0FSKSB7DQogICAgTWFwPFN0cmluZyxTdHJpbmc+IG91dHB1dFJvdyA9IFs6XQ0KICAgIA0KICAgIC8vIFZvdWNoZXIgaWRlbnRpZmljYXRpb24NCiAgICBTdHJpbmcgdnNlciA9IGlzQVIgPyByLmdldCgiRVNWU0VSIikgOiByLmdldCgiRVBWU0VSIikNCiAgICBTdHJpbmcgdm9ubyA9IGlzQVIgPyByLmdldCgiRVNWT05PIikgOiByLmdldCgiRVBWT05PIikNCiAgICBvdXRwdXRSb3cucHV0KCJWU0VSIiwgbnoodnNlcikpDQogICAgb3V0cHV0Um93LnB1dCgiVk9OTyIsIG56KHZvbm8pKQ0KICAgIG91dHB1dFJvdy5wdXQoIlNJREUiLCBpc0FSID8gIkN1c3RvbWVyIiA6ICJTdXBwbGllciIpDQogICAgDQogICAgLy8gRGF0ZXMNCiAgICBTdHJpbmcgYWNkdCA9IGlzQVIgPyByLmdldCgiRVNBQ0RUIikgOiByLmdldCgiRVBBQ0RUIikNCiAgICBvdXRwdXRSb3cucHV0KCJBQ0RUIiwgbnooYWNkdCkpDQogICAgb3V0cHV0Um93LnB1dCgiRFVEVCIsIG56KGlzQVIgPyByLmdldCgiRVNEVURUIikgOiByLmdldCgiRVBEVURUIikpKQ0KICAgIG91dHB1dFJvdy5wdXQoIklWRFQiLCBueihpc0FSID8gci5nZXQoIkVTSVZEVCIpIDogci5nZXQoIkVQSVZEVCIpKSkNCiAgICANCiAgICAvLyBDdXJyZW5jeSAvIGFtb3VudHMNCiAgICBTdHJpbmcgY3VhbVN0ciA9IGlzQVIgPyByLmdldCgiRVNDVUFNIikgOiByLmdldCgiRVBDVUFNIikNCiAgICBkb3VibGUgY3VhbSA9IHRvRG91YmxlKGN1YW1TdHIpDQogICAgb3V0cHV0Um93LnB1dCgiQ1VDRCIsIG56KGlzQVIgPyByLmdldCgiRVNDVUNEIikgOiByLmdldCgiRVBDVUNEIikpKQ0KICAgIG91dHB1dFJvdy5wdXQoIkNVQU0iLCBueihjdWFtU3RyKSkNCiAgICBvdXRwdXRSb3cucHV0KCJMQ0FNIiwgbnooci5nZXQoIkVHQUNBTSIpKSkNCiAgICANCiAgICAvLyBTaG9ydC9sb25nIHRleHQNCiAgICBvdXRwdXRSb3cucHV0KCJUWDE1Iiwgbnooci5nZXQoIkRWVFgxNSIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJWVFhUIiwgbnooci5nZXQoIkVHVlRYVCIpKSkNCiAgICANCiAgICAvLyBDaGVja3MgLyBiYW5rIC8gcHJvcG9zYWwNCiAgICAvL291dHB1dFJvdy5wdXQoIkNIS04iLCBueihyLmdldCgiQ0tDSEtOIikpKQ0KICAgIG91dHB1dFJvdy5wdXQoIkNIS04iLCBueihyLmdldCgiRVBQRVhJNDA0IikpKS8vWWFlbC4gMTcvMTEvMjAyNQ0KICAgIG91dHB1dFJvdy5wdXQoIkNDSEsiLCBueihyLmdldCgiQ1VTVF9DSyIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJTQ0NLIiwgbnooci5nZXQoIkNfU19DSyIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJCTktQIiwgbnooci5nZXQoIkJBTktfUEFHRSIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJQUlBOIiwgbnooci5nZXQoIlBST1BfTiIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJNQVNWIiwgbnooaXNBUiA/IHIuZ2V0KCJQUk9QX04iKSA6IHIuZ2V0KCJFUFBFWEkiKSkpDQogICAgDQogICAgLy8gS2V5cyAvIGlkZW50aWZpZXJzDQogICAgb3V0cHV0Um93LnB1dCgiWUVBNCIsIG56KGlzQVIgPyByLmdldCgiRVNZRUE0IikgOiByLmdldCgiRVBZRUE0IikpKQ0KICAgIG91dHB1dFJvdy5wdXQoIkpSTk8iLCBueihpc0FSID8gci5nZXQoIkVTSlJOTyIpIDogci5nZXQoIkVQSlJOTyIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJKU05PIiwgbnooaXNBUiA/IHIuZ2V0KCJFU0pTTk8iKSA6IHIuZ2V0KCJFUEpTTk8iKSkpDQogICAgDQogICAgLy8gQ291bnRlcnBhcnR5ICYgaW52b2ljZQ0KICAgIG91dHB1dFJvdy5wdXQoIlNVTk8iLCBueihpc0FSID8gci5nZXQoIkVTUFlOTyIpIDogci5nZXQoIkVQU1VOTyIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJTSU5PIiwgbnooaXNBUiA/IHIuZ2V0KCJFU0NJTk8iKSA6IHIuZ2V0KCJFUFNJTk8iKSkpDQogICAgDQogICAgLy8gTmFtZXMNCiAgICBvdXRwdXRSb3cucHV0KCJTVU5NIiwgbnooaXNBUiA/ICIiIDogci5nZXQoIklEU1VOTSIpKSkNCiAgICBvdXRwdXRSb3cucHV0KCJDVU5NIiwgbnooaXNBUiA/IHIuZ2V0KCJPS0NVTk0iKSA6ICIiKSkNCiAgICANCiAgICAvLyAtLS0tIE9wZW5pbmcgLyBEZWJpdCAvIENyZWRpdCAvIFJ1bm5pbmcgLS0tLQ0KICAgIG91dHB1dFJvdy5wdXQoIk9QQ1IiLCBmb3JtYXRBbW91bnQob3BlbmluZykpDQogICAgDQogICAgZG91YmxlIGRlYml0ID0gY3VhbSA+IDAgPyBjdWFtIDogMGQNCiAgICBkb3VibGUgY3JlZGl0ID0gY3VhbSA8IDAgPyAtY3VhbSA6IDBkDQogICAgDQogICAgb3V0cHV0Um93LnB1dCgiREVCVCIsIGZvcm1hdEFtb3VudChkZWJpdCkpDQogICAgb3V0cHV0Um93LnB1dCgiQ1JFRCIsIGZvcm1hdEFtb3VudChjcmVkaXQpKQ0KICAgIA0KICAgIHJ1bm5pbmcgKz0gKGRlYml0IC0gY3JlZGl0KQ0KICAgIG91dHB1dFJvdy5wdXQoIlJVTkIiLCBmb3JtYXRBbW91bnQocnVubmluZykpDQogICAgLy9ZYWVsLiAxOS4xMS4yMDI1DQogICAgLyppZihpc0FSKXsNCiAgICAgIA0KICAgIH1lbHNlew0KICAgICAgc2V0U3VwcGxpZXJBc21hY2h0YVZhbHVlKHIpOw0KICAgIH0qLw0KICAgIA0KICAgIG91dHB1dFJvdy5wdXQoIkFTTTEiLCByLmdldCgiQVNNMSIpKQ0KICAgIG91dHB1dFJvdy5wdXQoIkFTTTIiLCByLmdldCgiQVNNMiIpKQ0KICAgIC8vDQogICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INCyINGB0L/QuNGB0L7QuiDQstC80LXRgdGC0L4gbWkud3JpdGUoKQ0KICAgIGFsbFJvd3MuYWRkKG91dHB1dFJvdykNCn0NCg0KLy8g0J3QvtCy0YvQuSDQvNC10YLQvtC0INC00LvRjyDRgdC+0YDRgtC40YDQvtCy0LrQuCDQuCDQvtGC0L/RgNCw0LLQutC4INCyIG91dHB1dA0KICB2b2lkIHNlbmRUb091dHB1dCgpIHsNCiAgICAgIC8vINCh0L7RgNGC0LjRgNC+0LLQutCwINC/0L4gQUNEVA0KICAgICAgYWxsUm93cy5zb3J0IHsgaXQuQUNEVCB9DQogICAgICANCiAgICAgIC8vINCf0LXRgNC10YHRh9C40YLRi9Cy0LDQtdC8IHJ1bm5pbmcgYmFsYW5jZSDQv9C+0YHQu9C1INGB0L7RgNGC0LjRgNC+0LLQutC4DQogICAgICBydW5uaW5nID0gb3BlbmluZw0KICAgICAgZG91YmxlIHRvdGFsRGVidCA9IG9wZW5pbmcvL1lhZWwuIDE2LzExLzIwMjUNCiAgICAgIGRvdWJsZSB0b3RhbENyZWQgPSBvcGVuaW5nLy9ZYWVsLiAxNi8xMS8yMDI1DQogICAgICBNYXA8U3RyaW5nLCBTdHJpbmc+IG9wZW5pbmdCYWxhbmNlID0gW1JVTkI6IG9wZW5pbmcudG9TdHJpbmcoKSwgQUNEVDogYWxsUm93c1swXS5BQ0RUXQ0KICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiBjbG9zaW5nQmFsYW5jZSA9IFtSVU5COiBhbGxSb3dzWy0xXS5SVU5CLCBBQ0RUOiBhbGxSb3dzWy0xXS5BQ0RUXQ0KICAgIAkNCiAgICAJYWxsUm93cy5hZGQoMCwgb3BlbmluZ0JhbGFuY2UpDQogICAgCWFsbFJvd3MuYWRkKGNsb3NpbmdCYWxhbmNlKQ0KICAgIAkNCiAgICAgIGFsbFJvd3MuZWFjaFdpdGhJbmRleCB7IHJvdywgaW5kZXggLT4NCiAgICAgICAgICAvLyDQn9GA0L7Qv9GD0YHQutCw0LXQvCDRgNCw0YHRh9C10YIg0LTQu9GPINC/0LXRgNCy0L7QuSAoMCkg0Lgg0L/QvtGB0LvQtdC00L3QtdC5INGB0YLRgNC+0LrQuA0KICAgICAgICAgIGRvdWJsZSBkZWJ0ID0gdG9Eb3VibGUocm93LkRFQlQpDQogICAgICAgICAgZG91YmxlIGNyZWQgPSB0b0RvdWJsZShyb3cuQ1JFRCkNCiAgICAgICAgICANCiAgICAgICAgICBpbnQgbGFzdCA9IGFsbFJvd3Muc2l6ZSgpIC0gMQ0KICAgICAgICAgIA0KICAgICAgICAgIGlmIChpbmRleCAhPSAwICYmIGluZGV4ICE9IGxhc3QpIHsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIHRvdGFsRGVidCArPSBkZWJ0Ly9ZYWVsLiAxNi8xMS8yMDI1DQogICAgICAgICAgICAgIHRvdGFsQ3JlZCArPSBjcmVkLy9ZYWVsLiAxNi8xMS8yMDI1DQogICAgICAgICAgICAgIHJ1bm5pbmcgKz0gKGRlYnQgLSBjcmVkKQ0KICAgICAgICAgICAgICByb3cucHV0KCJSVU5CIiwgZm9ybWF0QW1vdW50KHJ1bm5pbmcpKQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIC8vINCU0LvRjyDQv9C10YDQstC+0Lkg0Lgg0L/QvtGB0LvQtdC00L3QtdC5INGB0YLRgNC+0LrQuCDQv9GA0L7RgdGC0L4g0YHRgtCw0LLQuNC8INGC0LXQutGD0YnQuNC5IHJ1bm5pbmcNCiAgICAgICAgICAgICAgaWYoaW5kZXggPT0gbGFzdCl7Ly9ZYWVsLiAxNi8xMS8yMDI1DQogICAgICAgICAgICAgICAgcm93LnB1dCgiREVCVCIsIGZvcm1hdEFtb3VudCh0b3RhbERlYnQpKS8vWWFlbC4gMTYvMTEvMjAyNQ0KICAgICAgICAgICAgICAgIHJvdy5wdXQoIkNSRUQiLCBmb3JtYXRBbW91bnQodG90YWxDcmVkKSkvL1lhZWwuIDE2LzExLzIwMjUNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICByb3cucHV0KCJSVU5CIiwgZm9ybWF0QW1vdW50KHJ1bm5pbmcpKQ0KICAgICAgICAgIH0NCiAgICAgICAgICANCiAgICAgICAgICAvLyDQntGC0L/RgNCw0LLQu9GP0LXQvCDQsiBtaS5vdXREYXRhDQogICAgICAgICAgcm93LmVhY2ggeyBrZXksIHZhbHVlIC0+DQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KGtleSwgdmFsdWUpDQogICAgICAgICAgfQ0KICAgICAgICAgIG1pLndyaXRlKCkNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g0J7Rh9C40YnQsNC10Lwg0YHQv9C40YHQvtC6DQogICAgICBhbGxSb3dzLmNsZWFyKCkNCiAgfQ0KDQoNCiAgLy8gLS0tLS0tLS0tLS0tLS0tLSBIZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0NCiAgcHJpdmF0ZSBTdHJpbmcgcyhPYmplY3QgbykgeyByZXR1cm4gbyA9PSBudWxsID8gIiIgOiBvLnRvU3RyaW5nKCkudHJpbSgpIH0NCiAgcHJpdmF0ZSBTdHJpbmcgbnooU3RyaW5nIHYpIHsgcmV0dXJuIHYgPT0gbnVsbCA/ICIiIDogdi50cmltKCkgfQ0KICBwcml2YXRlIGJvb2xlYW4gaXNFbXB0eShTdHJpbmcgeCkgeyByZXR1cm4geCA9PSBudWxsIHx8IHgudHJpbSgpLmlzRW1wdHkoKSB9DQoNCiAgcHJpdmF0ZSBTdHJpbmcgZmlyc3ROWjMoU3RyaW5nIGEsIFN0cmluZyBiLCBTdHJpbmcgYykgew0KICAgIGlmICghaXNFbXB0eShhKSkgcmV0dXJuIGENCiAgICBpZiAoIWlzRW1wdHkoYikpIHJldHVybiBiDQogICAgaWYgKCFpc0VtcHR5KGMpKSByZXR1cm4gYw0KICAgIHJldHVybiAiIg0KICB9DQoNCiAgcHJpdmF0ZSBpbnQgdG9JbnQoT2JqZWN0IG8pIHsNCiAgICBTdHJpbmcgeCA9IHMobykNCiAgICBpZiAoaXNFbXB0eSh4KSkgcmV0dXJuIDANCiAgICB0cnkgeyByZXR1cm4gSW50ZWdlci5wYXJzZUludCh4KSB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gbmZlKSB7IHJldHVybiAwIH0NCiAgfQ0KDQogIC8qKiBQcmltYXJ5ICsgZGVmYXVsdCAoZGVmYXVsdCBtYXkgYmUgbnVtYmVyIG9yIHN0cmluZykuICovDQogIHByaXZhdGUgaW50IHNhZmVJbnQyKE9iamVjdCBwcmltYXJ5LCBPYmplY3QgZGVmVmFsKSB7DQogICAgaW50IGRlZkludCA9IDANCiAgICBTdHJpbmcgZHMgPSBzKGRlZlZhbCkNCiAgICBpZiAoIWlzRW1wdHkoZHMpKSB7DQogICAgICB0cnkgeyBkZWZJbnQgPSBJbnRlZ2VyLnBhcnNlSW50KGRzKSB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gaWdub3JlKSB7IGRlZkludCA9IDAgfQ0KICAgIH0NCiAgICBTdHJpbmcgczEgPSBzKHByaW1hcnkpDQogICAgaWYgKGlzRW1wdHkoczEpKSByZXR1cm4gZGVmSW50DQogICAgdHJ5IHsgcmV0dXJuIEludGVnZXIucGFyc2VJbnQoczEpIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBpZ25vcmUpIHsgcmV0dXJuIGRlZkludCB9DQogIH0NCg0KICBwcml2YXRlIGRvdWJsZSB0b0RvdWJsZShPYmplY3Qgbykgew0KICAgIFN0cmluZyB4ID0gcyhvKQ0KICAgIGlmIChpc0VtcHR5KHgpKSByZXR1cm4gMGQNCiAgICB0cnkgeyByZXR1cm4gRG91YmxlLnBhcnNlRG91YmxlKHgpIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsgcmV0dXJuIDBkIH0NCiAgfQ0KDQogIHByaXZhdGUgU3RyaW5nIGZvcm1hdEFtb3VudChkb3VibGUgZCkgew0KICAgIGxvbmcgbGkgPSAobG9uZykgZA0KICAgIGlmIChNYXRoLmFicyhkIC0gbGkpIDwgMC4wMDAwMDAxZCkgcmV0dXJuIFN0cmluZy52YWx1ZU9mKGxpKQ0KICAgICAvLyBPdGhlcndpc2UgcmV0dXJuIHdpdGggMiBkZWNpbWFscw0KICAgIHJldHVybiBTdHJpbmcuZm9ybWF0KCIlLjJmIiwgZCk7DQogIH0NCiAgDQogIHByaXZhdGUgdm9pZCBzZXRTdXBwbGllckFzbWFjaHRhVmFsdWUoTWFwPFN0cmluZywgU3RyaW5nPiByKSB7Ly9ZYWVsLiAxOS4xMS8yMDI1DQogICAgU3RyaW5nIGNoa24gPSByLmdldCgiRVBQRVhJNDA0IikNCiAgICBTdHJpbmcgcG1zdiA9IHIuZ2V0KCJFUFBFWEk0MDYiKQ0KICAgIFN0cmluZyBybXN2ID0gci5nZXQoIkVQUEVYSSIpLy80MDkNCiAgICBTdHJpbmcgb3JpZ2luYWxTaW5vID0gci5nZXQoIkVQU0lOTyIpDQogICAgU3RyaW5nIGZlaWQgPSByLmdldCgiRUdGRUlEIikNCiAgICBpZihmZWlkICE9ICJBUDUwIiAmJiBmZWlkICE9ICJBUDEwIil7DQogICAgICBpZiAoY2hrbiAhPSBudWxsICYmICFjaGtuLnRyaW0oKS5pc0VtcHR5KCkgJiYgISJudWxsIi5lcXVhbHMoY2hrbikpIHsNCiAgICAgICAgICBjaGtuID0gY2hrbi5sZW5ndGgoKSA+IDEwID8gY2hrbi5zdWJzdHJpbmcoY2hrbi5sZW5ndGgoKSAtIDEwKSA6IGNoa24NCiAgICAgICAgICByLnB1dCgiQVNNMSIsIHN0cmlwTGVhZGluZ1plcm9zKGNoa24pKQ0KICAgICAgfWVsc2UgaWYgKHJtc3YgIT0gbnVsbCAmJiAhcm1zdi50cmltKCkuaXNFbXB0eSgpICYmICEibnVsbCIuZXF1YWxzKHJtc3YpKSB7DQogICAgICAgIHJtc3YgPSBybXN2Lmxlbmd0aCgpID4gMTAgPyBybXN2LnN1YnN0cmluZyhybXN2Lmxlbmd0aCgpIC0gMTApIDogcm1zdg0KICAgICAgICByLnB1dCgiQVNNMSIsIHJtc3YpDQogICAgICB9IGVsc2UgaWYgKHBtc3YgIT0gbnVsbCAmJiAhcG1zdi50cmltKCkuaXNFbXB0eSgpICYmICEibnVsbCIuZXF1YWxzKHBtc3YpKSB7DQogICAgICAgIHBtc3YgPSBwbXN2Lmxlbmd0aCgpID4gMTAgPyBwbXN2LnN1YnN0cmluZyhwbXN2Lmxlbmd0aCgpIC0gMTApIDogcG1zdg0KICAgICAgICByLnB1dCgiQVNNMSIsIHBtc3YpDQogICAgICB9DQogICAgICByLnB1dCgiQVNNMiIsIG9yaWdpbmFsU2lubykNCiAgICB9ZWxzZXsNCiAgICAgIGlmIChvcmlnaW5hbFNpbm8gIT0gbnVsbCAmJiAhb3JpZ2luYWxTaW5vLnRyaW0oKS5pc0VtcHR5KCkgJiYgISJudWxsIi5lcXVhbHMob3JpZ2luYWxTaW5vKSkgew0KICAgICAgICAgICAgci5wdXQoIkFTTTEiLCBvcmlnaW5hbFNpbm8pDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByLnB1dCgiQVNNMSIsICIiKQ0KICAgICAgICB9DQogICAgfQ0KCX0NCgkNCglwcml2YXRlIHZvaWQgc2V0Q3VzdG9tZXJBc21hY2h0YVZhbHVlKE1hcDxTdHJpbmcsIFN0cmluZz4gcikgey8vWWFlbC4gMTkuMTEvMjAyNQ0KICAgIFN0cmluZyBkZHJuID0gci5nZXQoIkRNRFJSTiIpDQogICAgU3RyaW5nIG9yaWdpbmFsQ2lubyA9IHIuZ2V0KCJFU0NJTk8iKQ0KICAgIFN0cmluZyBmZWlkID0gci5nZXQoIkVHRkVJRCIpDQogICAgaWYoZmVpZCA9PSAiQVIyMCIgJiYgZmVpZCA9PSAiT0kyMCIpew0KICAgICAgci5wdXQoIkFTTTEiLCBvcmlnaW5hbENpbm8pOw0KICAgIH1lbHNlIGlmKGZlaWQgPT0gIkFSMzAiICYmIGZlaWQgPT0gIkFCMTAiKXsNCiAgICAgIGlmKGRkcm4gIT0gbnVsbCAmJiAhZGRybi50cmltKCkuaXNFbXB0eSgpICYmICEibnVsbCIuZXF1YWxzKGRkcm4pKXsNCiAgICAgICAgci5wdXQoIkFTTTEiLCBkZHJuKQ0KICAgICAgICByLnB1dCgiQVNNMiIsIG9yaWdpbmFsQ2lubykNCiAgICAgIH0NCiAgICB9ZWxzZXsNCiAgICAgIHIucHV0KCJBU00xIiwgb3JpZ2luYWxDaW5vKQ0KICAgIH0NCgl9DQoJDQoJIHByaXZhdGUgU3RyaW5nIHN0cmlwTGVhZGluZ1plcm9zKFN0cmluZyB2YWx1ZSkgew0KICAgIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gbnVsbA0KICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlRmlyc3QoJ14wKyg/ISQpJywgJycpDQogIH0NCn0="}}}